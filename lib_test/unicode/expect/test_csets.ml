open! Import


let%expect_test "empty" =
  Format.printf "%a@." Cset.pp Cset.empty;
  [%expect {| |}]
;;

let%expect_test "ascii" =
  Format.printf "%a@." Cset.pp Cset.ascii;
  [%expect {| 0-127 |}]
;;

let%expect_test "cdigit" =
  Format.printf "%a@." Cset.pp Cset.cdigit;
  [%expect {|
    48-57, 1632-1641, 1776-1785, 1984-1993, 2406-2415, 2534-2543, 2662-2671,
    2790-2799, 2918-2927, 3046-3055, 3174-3183, 3302-3311, 3430-3439, 3558-3567,
    3664-3673, 3792-3801, 3872-3881, 4160-4169, 4240-4249, 6112-6121, 6160-6169,
    6470-6479, 6608-6617, 6784-6793, 6800-6809, 6992-7001, 7088-7097, 7232-7241,
    7248-7257, 42528-42537, 43216-43225, 43264-43273, 43472-43481, 43504-43513,
    43600-43609, 44016-44025, 65296-65305, 66720-66729, 68912-68921, 68928-68937,
    69734-69743, 69872-69881, 69942-69951, 70096-70105, 70384-70393, 70736-70745,
    70864-70873, 71248-71257, 71360-71369, 71376-71395, 71472-71481, 71904-71913,
    72016-72025, 72688-72697, 72784-72793, 73040-73049, 73120-73129, 73184-73193,
    73552-73561, 90416-90425, 92768-92777, 92864-92873, 93008-93017, 93552-93561,
    118000-118009, 120782-120831, 123200-123209, 123632-123641, 124144-124153,
    124401-124410, 125264-125273,
    130032-130041
    |}]
;;

let%expect_test "calpha" =
  Format.printf "%a@." Cset.pp Cset.calpha;
  [%expect {|
    65-90, 97-122, 170, 181, 186, 192-214, 216-246, 248-705, 710-721, 736-740,
    748, 750, 880-884, 886-887, 890-893, 895, 902, 904-906, 908, 910-929,
    931-1013, 1015-1153, 1162-1327, 1329-1366, 1369, 1376-1416, 1488-1514,
    1519-1522, 1568-1610, 1646-1647, 1649-1747, 1749, 1765-1766, 1774-1775,
    1786-1788, 1791, 1808, 1810-1839, 1869-1957, 1969, 1994-2026, 2036-2037,
    2042, 2048-2069, 2074, 2084, 2088, 2112-2136, 2144-2154, 2160-2183,
    2185-2191, 2208-2249, 2308-2361, 2365, 2384, 2392-2401, 2417-2432, 2437-2444,
    2447-2448, 2451-2472, 2474-2480, 2482, 2486-2489, 2493, 2510, 2524-2525,
    2527-2529, 2544-2545, 2556, 2565-2570, 2575-2576, 2579-2600, 2602-2608,
    2610-2611, 2613-2614, 2616-2617, 2649-2652, 2654, 2674-2676, 2693-2701,
    2703-2705, 2707-2728, 2730-2736, 2738-2739, 2741-2745, 2749, 2768, 2784-2785,
    2809, 2821-2828, 2831-2832, 2835-2856, 2858-2864, 2866-2867, 2869-2873, 2877,
    2908-2909, 2911-2913, 2929, 2947, 2949-2954, 2958-2960, 2962-2965, 2969-2970,
    2972, 2974-2975, 2979-2980, 2984-2986, 2990-3001, 3024, 3077-3084, 3086-3088,
    3090-3112, 3114-3129, 3133, 3160-3162, 3164-3165, 3168-3169, 3200, 3205-3212,
    3214-3216, 3218-3240, 3242-3251, 3253-3257, 3261, 3292-3294, 3296-3297,
    3313-3314, 3332-3340, 3342-3344, 3346-3386, 3389, 3406, 3412-3414, 3423-3425,
    3450-3455, 3461-3478, 3482-3505, 3507-3515, 3517, 3520-3526, 3585-3632,
    3634-3635, 3648-3654, 3713-3714, 3716, 3718-3722, 3724-3747, 3749, 3751-3760,
    3762-3763, 3773, 3776-3780, 3782, 3804-3807, 3840, 3904-3911, 3913-3948,
    3976-3980, 4096-4138, 4159, 4176-4181, 4186-4189, 4193, 4197-4198, 4206-4208,
    4213-4225, 4238, 4256-4293, 4295, 4301, 4304-4346, 4348-4680, 4682-4685,
    4688-4694, 4696, 4698-4701, 4704-4744, 4746-4749, 4752-4784, 4786-4789,
    4792-4798, 4800, 4802-4805, 4808-4822, 4824-4880, 4882-4885, 4888-4954,
    4992-5007, 5024-5109, 5112-5117, 5121-5740, 5743-5759, 5761-5786, 5792-5866,
    5873-5880, 5888-5905, 5919-5937, 5952-5969, 5984-5996, 5998-6000, 6016-6067,
    6103, 6108, 6176-6264, 6272-6276, 6279-6312, 6314, 6320-6389, 6400-6430,
    6480-6509, 6512-6516, 6528-6571, 6576-6601, 6656-6678, 6688-6740, 6823,
    6917-6963, 6981-6988, 7043-7072, 7086-7087, 7098-7141, 7168-7203, 7245-7247,
    7258-7293, 7296-7306, 7312-7354, 7357-7359, 7401-7404, 7406-7411, 7413-7414,
    7418, 7424-7615, 7680-7957, 7960-7965, 7968-8005, 8008-8013, 8016-8023, 8025,
    8027, 8029, 8031-8061, 8064-8116, 8118-8124, 8126, 8130-8132, 8134-8140,
    8144-8147, 8150-8155, 8160-8172, 8178-8180, 8182-8188, 8305, 8319, 8336-8348,
    8450, 8455, 8458-8467, 8469, 8473-8477, 8484, 8486, 8488, 8490-8493,
    8495-8505, 8508-8511, 8517-8521, 8526, 8579-8580, 11264-11492, 11499-11502,
    11506-11507, 11520-11557, 11559, 11565, 11568-11623, 11631, 11648-11670,
    11680-11686, 11688-11694, 11696-11702, 11704-11710, 11712-11718, 11720-11726,
    11728-11734, 11736-11742, 11823, 12293-12294, 12337-12341, 12347-12348,
    12353-12438, 12445-12447, 12449-12538, 12540-12543, 12549-12591, 12593-12686,
    12704-12735, 12784-12799, 13312-19903, 19968-42124, 42192-42237, 42240-42508,
    42512-42527, 42538-42539, 42560-42606, 42623-42653, 42656-42725, 42775-42783,
    42786-42888, 42891-42972, 42993-43009, 43011-43013, 43015-43018, 43020-43042,
    43072-43123, 43138-43187, 43250-43255, 43259, 43261-43262, 43274-43301,
    43312-43334, 43360-43388, 43396-43442, 43471, 43488-43492, 43494-43503,
    43514-43518, 43520-43560, 43584-43586, 43588-43595, 43616-43638, 43642,
    43646-43695, 43697, 43701-43702, 43705-43709, 43712, 43714, 43739-43741,
    43744-43754, 43762-43764, 43777-43782, 43785-43790, 43793-43798, 43808-43814,
    43816-43822, 43824-43866, 43868-43881, 43888-44002, 44032-55203, 55216-55238,
    55243-55291, 63744-64109, 64112-64217, 64256-64262, 64275-64279, 64285,
    64287-64296, 64298-64310, 64312-64316, 64318, 64320-64321, 64323-64324,
    64326-64433, 64467-64829, 64848-64911, 64914-64967, 65008-65019, 65136-65140,
    65142-65276, 65313-65338, 65345-65370, 65382-65470, 65474-65479, 65482-65487,
    65490-65495, 65498-65500, 65536-65547, 65549-65574, 65576-65594, 65596-65597,
    65599-65613, 65616-65629, 65664-65786, 66176-66204, 66208-66256, 66304-66335,
    66349-66368, 66370-66377, 66384-66421, 66432-66461, 66464-66499, 66504-66511,
    66560-66717, 66736-66771, 66776-66811, 66816-66855, 66864-66915, 66928-66938,
    66940-66954, 66956-66962, 66964-66965, 66967-66977, 66979-66993, 66995-67001,
    67003-67004, 67008-67059, 67072-67382, 67392-67413, 67424-67431, 67456-67461,
    67463-67504, 67506-67514, 67584-67589, 67592, 67594-67637, 67639-67640,
    67644, 67647-67669, 67680-67702, 67712-67742, 67808-67826, 67828-67829,
    67840-67861, 67872-67897, 67904-67929, 67968-68023, 68030-68031, 68096,
    68112-68115, 68117-68119, 68121-68149, 68192-68220, 68224-68252, 68288-68295,
    68297-68324, 68352-68405, 68416-68437, 68448-68466, 68480-68497, 68608-68680,
    68736-68786, 68800-68850, 68864-68899, 68938-68965, 68975-68997, 69248-69289,
    69296-69297, 69314-69319, 69376-69404, 69415, 69424-69445, 69488-69505,
    69552-69572, 69600-69622, 69635-69687, 69745-69746, 69749, 69763-69807,
    69840-69864, 69891-69926, 69956, 69959, 69968-70002, 70006, 70019-70066,
    70081-70084, 70106, 70108, 70144-70161, 70163-70187, 70207-70208,
    70272-70278, 70280, 70282-70285, 70287-70301, 70303-70312, 70320-70366,
    70405-70412, 70415-70416, 70419-70440, 70442-70448, 70450-70451, 70453-70457,
    70461, 70480, 70493-70497, 70528-70537, 70539, 70542, 70544-70581, 70583,
    70609, 70611, 70656-70708, 70727-70730, 70751-70753, 70784-70831,
    70852-70853, 70855, 71040-71086, 71128-71131, 71168-71215, 71236,
    71296-71338, 71352, 71424-71450, 71488-71494, 71680-71723, 71840-71903,
    71935-71942, 71945, 71948-71955, 71957-71958, 71960-71983, 71999, 72001,
    72096-72103, 72106-72144, 72161, 72163, 72192, 72203-72242, 72250, 72272,
    72284-72329, 72349, 72368-72440, 72640-72672, 72704-72712, 72714-72750,
    72768, 72818-72847, 72960-72966, 72968-72969, 72971-73008, 73030,
    73056-73061, 73063-73064, 73066-73097, 73112, 73136-73179, 73440-73458,
    73474, 73476-73488, 73490-73523, 73648, 73728-74649, 74880-75075,
    77712-77808, 77824-78895, 78913-78918, 78944-82938, 82944-83526, 90368-90397,
    92160-92728, 92736-92766, 92784-92862, 92880-92909, 92928-92975, 92992-92995,
    93027-93047, 93053-93071, 93504-93548, 93760-93823, 93856-93880, 93883-93907,
    93952-94026, 94032, 94099-94111, 94176-94177, 94179, 94194-94195,
    94208-101589, 101631-101662, 101760-101874, 110576-110579, 110581-110587,
    110589-110590, 110592-110882, 110898, 110928-110930, 110933, 110948-110951,
    110960-111355, 113664-113770, 113776-113788, 113792-113800, 113808-113817,
    119808-119892, 119894-119964, 119966-119967, 119970, 119973-119974,
    119977-119980, 119982-119993, 119995, 119997-120003, 120005-120069,
    120071-120074, 120077-120084, 120086-120092, 120094-120121, 120123-120126,
    120128-120132, 120134, 120138-120144, 120146-120485, 120488-120512,
    120514-120538, 120540-120570, 120572-120596, 120598-120628, 120630-120654,
    120656-120686, 120688-120712, 120714-120744, 120746-120770, 120772-120779,
    122624-122654, 122661-122666, 122928-122989, 123136-123180, 123191-123197,
    123214, 123536-123565, 123584-123627, 124112-124139, 124368-124397, 124400,
    124608-124638, 124640-124642, 124644-124645, 124647-124653, 124656-124660,
    124670-124671, 124896-124902, 124904-124907, 124909-124910, 124912-124926,
    124928-125124, 125184-125251, 125259, 126464-126467, 126469-126495,
    126497-126498, 126500, 126503, 126505-126514, 126516-126519, 126521, 126523,
    126530, 126535, 126537, 126539, 126541-126543, 126545-126546, 126548, 126551,
    126553, 126555, 126557, 126559, 126561-126562, 126564, 126567-126570,
    126572-126578, 126580-126583, 126585-126588, 126590, 126592-126601,
    126603-126619, 126625-126627, 126629-126633, 126635-126651, 131072-173791,
    173824-178205, 178208-183981, 183984-191456, 191472-192093, 194560-195101,
    196608-201546,
    201552-210041
    |}]
;;

let%expect_test "cword" =
  Format.printf "%a@." Cset.pp Cset.cword;
  [%expect {|
    48-57, 65-90, 95, 97-122, 170, 178-179, 181, 185-186, 188-190, 192-214,
    216-246, 248-705, 710-721, 736-740, 748, 750, 880-884, 886-887, 890-893, 895,
    902, 904-906, 908, 910-929, 931-1013, 1015-1153, 1162-1327, 1329-1366, 1369,
    1376-1416, 1488-1514, 1519-1522, 1568-1610, 1632-1641, 1646-1647, 1649-1747,
    1749, 1765-1766, 1774-1788, 1791, 1808, 1810-1839, 1869-1957, 1969,
    1984-2026, 2036-2037, 2042, 2048-2069, 2074, 2084, 2088, 2112-2136,
    2144-2154, 2160-2183, 2185-2191, 2208-2249, 2308-2361, 2365, 2384, 2392-2401,
    2406-2415, 2417-2432, 2437-2444, 2447-2448, 2451-2472, 2474-2480, 2482,
    2486-2489, 2493, 2510, 2524-2525, 2527-2529, 2534-2545, 2548-2553, 2556,
    2565-2570, 2575-2576, 2579-2600, 2602-2608, 2610-2611, 2613-2614, 2616-2617,
    2649-2652, 2654, 2662-2671, 2674-2676, 2693-2701, 2703-2705, 2707-2728,
    2730-2736, 2738-2739, 2741-2745, 2749, 2768, 2784-2785, 2790-2799, 2809,
    2821-2828, 2831-2832, 2835-2856, 2858-2864, 2866-2867, 2869-2873, 2877,
    2908-2909, 2911-2913, 2918-2927, 2929-2935, 2947, 2949-2954, 2958-2960,
    2962-2965, 2969-2970, 2972, 2974-2975, 2979-2980, 2984-2986, 2990-3001, 3024,
    3046-3058, 3077-3084, 3086-3088, 3090-3112, 3114-3129, 3133, 3160-3162,
    3164-3165, 3168-3169, 3174-3183, 3192-3198, 3200, 3205-3212, 3214-3216,
    3218-3240, 3242-3251, 3253-3257, 3261, 3292-3294, 3296-3297, 3302-3311,
    3313-3314, 3332-3340, 3342-3344, 3346-3386, 3389, 3406, 3412-3414, 3416-3425,
    3430-3448, 3450-3455, 3461-3478, 3482-3505, 3507-3515, 3517, 3520-3526,
    3558-3567, 3585-3632, 3634-3635, 3648-3654, 3664-3673, 3713-3714, 3716,
    3718-3722, 3724-3747, 3749, 3751-3760, 3762-3763, 3773, 3776-3780, 3782,
    3792-3801, 3804-3807, 3840, 3872-3891, 3904-3911, 3913-3948, 3976-3980,
    4096-4138, 4159-4169, 4176-4181, 4186-4189, 4193, 4197-4198, 4206-4208,
    4213-4225, 4238, 4240-4249, 4256-4293, 4295, 4301, 4304-4346, 4348-4680,
    4682-4685, 4688-4694, 4696, 4698-4701, 4704-4744, 4746-4749, 4752-4784,
    4786-4789, 4792-4798, 4800, 4802-4805, 4808-4822, 4824-4880, 4882-4885,
    4888-4954, 4969-4988, 4992-5007, 5024-5109, 5112-5117, 5121-5740, 5743-5759,
    5761-5786, 5792-5866, 5870-5880, 5888-5905, 5919-5937, 5952-5969, 5984-5996,
    5998-6000, 6016-6067, 6103, 6108, 6112-6121, 6128-6137, 6160-6169, 6176-6264,
    6272-6276, 6279-6312, 6314, 6320-6389, 6400-6430, 6470-6509, 6512-6516,
    6528-6571, 6576-6601, 6608-6618, 6656-6678, 6688-6740, 6784-6793, 6800-6809,
    6823, 6917-6963, 6981-6988, 6992-7001, 7043-7072, 7086-7141, 7168-7203,
    7232-7241, 7245-7293, 7296-7306, 7312-7354, 7357-7359, 7401-7404, 7406-7411,
    7413-7414, 7418, 7424-7615, 7680-7957, 7960-7965, 7968-8005, 8008-8013,
    8016-8023, 8025, 8027, 8029, 8031-8061, 8064-8116, 8118-8124, 8126,
    8130-8132, 8134-8140, 8144-8147, 8150-8155, 8160-8172, 8178-8180, 8182-8188,
    8304-8305, 8308-8313, 8319-8329, 8336-8348, 8450, 8455, 8458-8467, 8469,
    8473-8477, 8484, 8486, 8488, 8490-8493, 8495-8505, 8508-8511, 8517-8521,
    8526, 8528-8585, 9312-9371, 9450-9471, 10102-10131, 11264-11492, 11499-11502,
    11506-11507, 11517, 11520-11557, 11559, 11565, 11568-11623, 11631,
    11648-11670, 11680-11686, 11688-11694, 11696-11702, 11704-11710, 11712-11718,
    11720-11726, 11728-11734, 11736-11742, 11823, 12293-12295, 12321-12329,
    12337-12341, 12344-12348, 12353-12438, 12445-12447, 12449-12538, 12540-12543,
    12549-12591, 12593-12686, 12690-12693, 12704-12735, 12784-12799, 12832-12841,
    12872-12879, 12881-12895, 12928-12937, 12977-12991, 13312-19903, 19968-42124,
    42192-42237, 42240-42508, 42512-42539, 42560-42606, 42623-42653, 42656-42735,
    42775-42783, 42786-42888, 42891-42972, 42993-43009, 43011-43013, 43015-43018,
    43020-43042, 43056-43061, 43072-43123, 43138-43187, 43216-43225, 43250-43255,
    43259, 43261-43262, 43264-43301, 43312-43334, 43360-43388, 43396-43442,
    43471-43481, 43488-43492, 43494-43518, 43520-43560, 43584-43586, 43588-43595,
    43600-43609, 43616-43638, 43642, 43646-43695, 43697, 43701-43702,
    43705-43709, 43712, 43714, 43739-43741, 43744-43754, 43762-43764,
    43777-43782, 43785-43790, 43793-43798, 43808-43814, 43816-43822, 43824-43866,
    43868-43881, 43888-44002, 44016-44025, 44032-55203, 55216-55238, 55243-55291,
    63744-64109, 64112-64217, 64256-64262, 64275-64279, 64285, 64287-64296,
    64298-64310, 64312-64316, 64318, 64320-64321, 64323-64324, 64326-64433,
    64467-64829, 64848-64911, 64914-64967, 65008-65019, 65136-65140, 65142-65276,
    65296-65305, 65313-65338, 65345-65370, 65382-65470, 65474-65479, 65482-65487,
    65490-65495, 65498-65500, 65536-65547, 65549-65574, 65576-65594, 65596-65597,
    65599-65613, 65616-65629, 65664-65786, 65799-65843, 65856-65912, 65930-65931,
    66176-66204, 66208-66256, 66273-66299, 66304-66339, 66349-66378, 66384-66421,
    66432-66461, 66464-66499, 66504-66511, 66513-66517, 66560-66717, 66720-66729,
    66736-66771, 66776-66811, 66816-66855, 66864-66915, 66928-66938, 66940-66954,
    66956-66962, 66964-66965, 66967-66977, 66979-66993, 66995-67001, 67003-67004,
    67008-67059, 67072-67382, 67392-67413, 67424-67431, 67456-67461, 67463-67504,
    67506-67514, 67584-67589, 67592, 67594-67637, 67639-67640, 67644,
    67647-67669, 67672-67702, 67705-67742, 67751-67759, 67808-67826, 67828-67829,
    67835-67867, 67872-67897, 67904-67929, 67968-68023, 68028-68047, 68050-68096,
    68112-68115, 68117-68119, 68121-68149, 68160-68168, 68192-68222, 68224-68255,
    68288-68295, 68297-68324, 68331-68335, 68352-68405, 68416-68437, 68440-68466,
    68472-68497, 68521-68527, 68608-68680, 68736-68786, 68800-68850, 68858-68899,
    68912-68921, 68928-68965, 68975-68997, 69216-69246, 69248-69289, 69296-69297,
    69314-69319, 69376-69415, 69424-69445, 69457-69460, 69488-69505, 69552-69579,
    69600-69622, 69635-69687, 69714-69743, 69745-69746, 69749, 69763-69807,
    69840-69864, 69872-69881, 69891-69926, 69942-69951, 69956, 69959,
    69968-70002, 70006, 70019-70066, 70081-70084, 70096-70106, 70108,
    70113-70132, 70144-70161, 70163-70187, 70207-70208, 70272-70278, 70280,
    70282-70285, 70287-70301, 70303-70312, 70320-70366, 70384-70393, 70405-70412,
    70415-70416, 70419-70440, 70442-70448, 70450-70451, 70453-70457, 70461,
    70480, 70493-70497, 70528-70537, 70539, 70542, 70544-70581, 70583, 70609,
    70611, 70656-70708, 70727-70730, 70736-70745, 70751-70753, 70784-70831,
    70852-70853, 70855, 70864-70873, 71040-71086, 71128-71131, 71168-71215,
    71236, 71248-71257, 71296-71338, 71352, 71360-71369, 71376-71395,
    71424-71450, 71472-71483, 71488-71494, 71680-71723, 71840-71922, 71935-71942,
    71945, 71948-71955, 71957-71958, 71960-71983, 71999, 72001, 72016-72025,
    72096-72103, 72106-72144, 72161, 72163, 72192, 72203-72242, 72250, 72272,
    72284-72329, 72349, 72368-72440, 72640-72672, 72688-72697, 72704-72712,
    72714-72750, 72768, 72784-72812, 72818-72847, 72960-72966, 72968-72969,
    72971-73008, 73030, 73040-73049, 73056-73061, 73063-73064, 73066-73097,
    73112, 73120-73129, 73136-73179, 73184-73193, 73440-73458, 73474,
    73476-73488, 73490-73523, 73552-73561, 73648, 73664-73684, 73728-74649,
    74752-74862, 74880-75075, 77712-77808, 77824-78895, 78913-78918, 78944-82938,
    82944-83526, 90368-90397, 90416-90425, 92160-92728, 92736-92766, 92768-92777,
    92784-92862, 92864-92873, 92880-92909, 92928-92975, 92992-92995, 93008-93017,
    93019-93025, 93027-93047, 93053-93071, 93504-93548, 93552-93561, 93760-93846,
    93856-93880, 93883-93907, 93952-94026, 94032, 94099-94111, 94176-94177,
    94179, 94194-94198, 94208-101589, 101631-101662, 101760-101874,
    110576-110579, 110581-110587, 110589-110590, 110592-110882, 110898,
    110928-110930, 110933, 110948-110951, 110960-111355, 113664-113770,
    113776-113788, 113792-113800, 113808-113817, 118000-118009, 119488-119507,
    119520-119539, 119648-119672, 119808-119892, 119894-119964, 119966-119967,
    119970, 119973-119974, 119977-119980, 119982-119993, 119995, 119997-120003,
    120005-120069, 120071-120074, 120077-120084, 120086-120092, 120094-120121,
    120123-120126, 120128-120132, 120134, 120138-120144, 120146-120485,
    120488-120512, 120514-120538, 120540-120570, 120572-120596, 120598-120628,
    120630-120654, 120656-120686, 120688-120712, 120714-120744, 120746-120770,
    120772-120779, 120782-120831, 122624-122654, 122661-122666, 122928-122989,
    123136-123180, 123191-123197, 123200-123209, 123214, 123536-123565,
    123584-123627, 123632-123641, 124112-124139, 124144-124153, 124368-124397,
    124400-124410, 124608-124638, 124640-124642, 124644-124645, 124647-124653,
    124656-124660, 124670-124671, 124896-124902, 124904-124907, 124909-124910,
    124912-124926, 124928-125124, 125127-125135, 125184-125251, 125259,
    125264-125273, 126065-126123, 126125-126127, 126129-126132, 126209-126253,
    126255-126269, 126464-126467, 126469-126495, 126497-126498, 126500, 126503,
    126505-126514, 126516-126519, 126521, 126523, 126530, 126535, 126537, 126539,
    126541-126543, 126545-126546, 126548, 126551, 126553, 126555, 126557, 126559,
    126561-126562, 126564, 126567-126570, 126572-126578, 126580-126583,
    126585-126588, 126590, 126592-126601, 126603-126619, 126625-126627,
    126629-126633, 126635-126651, 127232-127244, 130032-130041, 131072-173791,
    173824-178205, 178208-183981, 183984-191456, 191472-192093, 194560-195101,
    196608-201546,
    201552-210041
    |}]
;;

let%expect_test "notnl" =
  Format.printf "%a@." Cset.pp Cset.notnl;
  [%expect {|
    0-9, 14-132, 134-8231, 8234-55295,
    57344-1114111
    |}]
;;

let%expect_test "nl" =
  Format.printf "%a@." Cset.pp Cset.nl;
  [%expect {|
    10-13, 133,
    8232-8233
    |}]
;;

let%expect_test "blank" =
  Format.printf "%a@." Cset.pp Cset.blank;
  [%expect {|
    9,
    32
    |}]
;;

let%expect_test "space" =
  Format.printf "%a@." Cset.pp Cset.space;
  [%expect {|
    9-13, 32, 133, 160, 5760, 8192-8202, 8232-8233, 8239, 8287,
    12288
    |}]
;;

let%expect_test "xdigit" =
  Format.printf "%a@." Cset.pp Cset.xdigit;
  [%expect {|
    48-57, 65-70, 97-102, 65296-65305, 65313-65318,
    65345-65350
    |}]
;;

let%expect_test "lower" =
  Format.printf "%a@." Cset.pp Cset.lower;
  [%expect {|
    97-122, 170, 181, 186, 223-246, 248-255, 257, 259, 261, 263, 265, 267, 269,
    271, 273, 275, 277, 279, 281, 283, 285, 287, 289, 291, 293, 295, 297, 299,
    301, 303, 305, 307, 309, 311-312, 314, 316, 318, 320, 322, 324, 326, 328-329,
    331, 333, 335, 337, 339, 341, 343, 345, 347, 349, 351, 353, 355, 357, 359,
    361, 363, 365, 367, 369, 371, 373, 375, 378, 380, 382-384, 387, 389, 392,
    396-397, 402, 405, 409-411, 414, 417, 419, 421, 424, 426-427, 429, 432, 436,
    438, 441-442, 445-447, 454, 457, 460, 462, 464, 466, 468, 470, 472, 474,
    476-477, 479, 481, 483, 485, 487, 489, 491, 493, 495-496, 499, 501, 505, 507,
    509, 511, 513, 515, 517, 519, 521, 523, 525, 527, 529, 531, 533, 535, 537,
    539, 541, 543, 545, 547, 549, 551, 553, 555, 557, 559, 561, 563-569, 572,
    575-576, 578, 583, 585, 587, 589, 591-659, 662-696, 704-705, 736-740, 837,
    881, 883, 887, 890-893, 912, 940-974, 976-977, 981-983, 985, 987, 989, 991,
    993, 995, 997, 999, 1001, 1003, 1005, 1007-1011, 1013, 1016, 1019-1020,
    1072-1119, 1121, 1123, 1125, 1127, 1129, 1131, 1133, 1135, 1137, 1139, 1141,
    1143, 1145, 1147, 1149, 1151, 1153, 1163, 1165, 1167, 1169, 1171, 1173, 1175,
    1177, 1179, 1181, 1183, 1185, 1187, 1189, 1191, 1193, 1195, 1197, 1199, 1201,
    1203, 1205, 1207, 1209, 1211, 1213, 1215, 1218, 1220, 1222, 1224, 1226, 1228,
    1230-1231, 1233, 1235, 1237, 1239, 1241, 1243, 1245, 1247, 1249, 1251, 1253,
    1255, 1257, 1259, 1261, 1263, 1265, 1267, 1269, 1271, 1273, 1275, 1277, 1279,
    1281, 1283, 1285, 1287, 1289, 1291, 1293, 1295, 1297, 1299, 1301, 1303, 1305,
    1307, 1309, 1311, 1313, 1315, 1317, 1319, 1321, 1323, 1325, 1327, 1376-1416,
    4304-4346, 4348-4351, 5112-5117, 7296-7304, 7306, 7424-7615, 7681, 7683,
    7685, 7687, 7689, 7691, 7693, 7695, 7697, 7699, 7701, 7703, 7705, 7707, 7709,
    7711, 7713, 7715, 7717, 7719, 7721, 7723, 7725, 7727, 7729, 7731, 7733, 7735,
    7737, 7739, 7741, 7743, 7745, 7747, 7749, 7751, 7753, 7755, 7757, 7759, 7761,
    7763, 7765, 7767, 7769, 7771, 7773, 7775, 7777, 7779, 7781, 7783, 7785, 7787,
    7789, 7791, 7793, 7795, 7797, 7799, 7801, 7803, 7805, 7807, 7809, 7811, 7813,
    7815, 7817, 7819, 7821, 7823, 7825, 7827, 7829-7837, 7839, 7841, 7843, 7845,
    7847, 7849, 7851, 7853, 7855, 7857, 7859, 7861, 7863, 7865, 7867, 7869, 7871,
    7873, 7875, 7877, 7879, 7881, 7883, 7885, 7887, 7889, 7891, 7893, 7895, 7897,
    7899, 7901, 7903, 7905, 7907, 7909, 7911, 7913, 7915, 7917, 7919, 7921, 7923,
    7925, 7927, 7929, 7931, 7933, 7935-7943, 7952-7957, 7968-7975, 7984-7991,
    8000-8005, 8016-8023, 8032-8039, 8048-8061, 8064-8071, 8080-8087, 8096-8103,
    8112-8116, 8118-8119, 8126, 8130-8132, 8134-8135, 8144-8147, 8150-8151,
    8160-8167, 8178-8180, 8182-8183, 8305, 8319, 8336-8348, 8458, 8462-8463,
    8467, 8495, 8500, 8505, 8508-8509, 8518-8521, 8526, 8560-8575, 8580,
    9424-9449, 11312-11359, 11361, 11365-11366, 11368, 11370, 11372, 11377,
    11379-11380, 11382-11389, 11393, 11395, 11397, 11399, 11401, 11403, 11405,
    11407, 11409, 11411, 11413, 11415, 11417, 11419, 11421, 11423, 11425, 11427,
    11429, 11431, 11433, 11435, 11437, 11439, 11441, 11443, 11445, 11447, 11449,
    11451, 11453, 11455, 11457, 11459, 11461, 11463, 11465, 11467, 11469, 11471,
    11473, 11475, 11477, 11479, 11481, 11483, 11485, 11487, 11489, 11491-11492,
    11500, 11502, 11507, 11520-11557, 11559, 11565, 42561, 42563, 42565, 42567,
    42569, 42571, 42573, 42575, 42577, 42579, 42581, 42583, 42585, 42587, 42589,
    42591, 42593, 42595, 42597, 42599, 42601, 42603, 42605, 42625, 42627, 42629,
    42631, 42633, 42635, 42637, 42639, 42641, 42643, 42645, 42647, 42649,
    42651-42653, 42787, 42789, 42791, 42793, 42795, 42797, 42799-42801, 42803,
    42805, 42807, 42809, 42811, 42813, 42815, 42817, 42819, 42821, 42823, 42825,
    42827, 42829, 42831, 42833, 42835, 42837, 42839, 42841, 42843, 42845, 42847,
    42849, 42851, 42853, 42855, 42857, 42859, 42861, 42863-42872, 42874, 42876,
    42879, 42881, 42883, 42885, 42887, 42892, 42894, 42897, 42899-42901, 42903,
    42905, 42907, 42909, 42911, 42913, 42915, 42917, 42919, 42921, 42927, 42933,
    42935, 42937, 42939, 42941, 42943, 42945, 42947, 42952, 42954, 42957, 42959,
    42961, 42963, 42965, 42967, 42969, 42971, 42993-42996, 42998, 43000-43002,
    43824-43866, 43868-43881, 43888-43967, 64256-64262, 64275-64279, 65345-65370,
    66600-66639, 66776-66811, 66967-66977, 66979-66993, 66995-67001, 67003-67004,
    67456, 67459-67461, 67463-67504, 67506-67514, 68800-68850, 68976-68997,
    71872-71903, 93792-93823, 93883-93907, 119834-119859, 119886-119892,
    119894-119911, 119938-119963, 119990-119993, 119995, 119997-120003,
    120005-120015, 120042-120067, 120094-120119, 120146-120171, 120198-120223,
    120250-120275, 120302-120327, 120354-120379, 120406-120431, 120458-120485,
    120514-120538, 120540-120545, 120572-120596, 120598-120603, 120630-120654,
    120656-120661, 120688-120712, 120714-120719, 120746-120770, 120772-120777,
    120779, 122624-122633, 122635-122654, 122661-122666, 122928-122989,
    125218-125251
    |}]
;;

let%expect_test "upper" =
  Format.printf "%a@." Cset.pp Cset.upper;
  [%expect {|
    65-90, 192-214, 216-222, 256, 258, 260, 262, 264, 266, 268, 270, 272, 274,
    276, 278, 280, 282, 284, 286, 288, 290, 292, 294, 296, 298, 300, 302, 304,
    306, 308, 310, 313, 315, 317, 319, 321, 323, 325, 327, 330, 332, 334, 336,
    338, 340, 342, 344, 346, 348, 350, 352, 354, 356, 358, 360, 362, 364, 366,
    368, 370, 372, 374, 376-377, 379, 381, 385-386, 388, 390-391, 393-395,
    398-401, 403-404, 406-408, 412-413, 415-416, 418, 420, 422-423, 425, 428,
    430-431, 433-435, 437, 439-440, 444, 452, 455, 458, 461, 463, 465, 467, 469,
    471, 473, 475, 478, 480, 482, 484, 486, 488, 490, 492, 494, 497, 500,
    502-504, 506, 508, 510, 512, 514, 516, 518, 520, 522, 524, 526, 528, 530,
    532, 534, 536, 538, 540, 542, 544, 546, 548, 550, 552, 554, 556, 558, 560,
    562, 570-571, 573-574, 577, 579-582, 584, 586, 588, 590, 880, 882, 886, 895,
    902, 904-906, 908, 910-911, 913-929, 931-939, 975, 978-980, 984, 986, 988,
    990, 992, 994, 996, 998, 1000, 1002, 1004, 1006, 1012, 1015, 1017-1018,
    1021-1071, 1120, 1122, 1124, 1126, 1128, 1130, 1132, 1134, 1136, 1138, 1140,
    1142, 1144, 1146, 1148, 1150, 1152, 1162, 1164, 1166, 1168, 1170, 1172, 1174,
    1176, 1178, 1180, 1182, 1184, 1186, 1188, 1190, 1192, 1194, 1196, 1198, 1200,
    1202, 1204, 1206, 1208, 1210, 1212, 1214, 1216-1217, 1219, 1221, 1223, 1225,
    1227, 1229, 1232, 1234, 1236, 1238, 1240, 1242, 1244, 1246, 1248, 1250, 1252,
    1254, 1256, 1258, 1260, 1262, 1264, 1266, 1268, 1270, 1272, 1274, 1276, 1278,
    1280, 1282, 1284, 1286, 1288, 1290, 1292, 1294, 1296, 1298, 1300, 1302, 1304,
    1306, 1308, 1310, 1312, 1314, 1316, 1318, 1320, 1322, 1324, 1326, 1329-1366,
    4256-4293, 4295, 4301, 5024-5109, 7305, 7312-7354, 7357-7359, 7680, 7682,
    7684, 7686, 7688, 7690, 7692, 7694, 7696, 7698, 7700, 7702, 7704, 7706, 7708,
    7710, 7712, 7714, 7716, 7718, 7720, 7722, 7724, 7726, 7728, 7730, 7732, 7734,
    7736, 7738, 7740, 7742, 7744, 7746, 7748, 7750, 7752, 7754, 7756, 7758, 7760,
    7762, 7764, 7766, 7768, 7770, 7772, 7774, 7776, 7778, 7780, 7782, 7784, 7786,
    7788, 7790, 7792, 7794, 7796, 7798, 7800, 7802, 7804, 7806, 7808, 7810, 7812,
    7814, 7816, 7818, 7820, 7822, 7824, 7826, 7828, 7838, 7840, 7842, 7844, 7846,
    7848, 7850, 7852, 7854, 7856, 7858, 7860, 7862, 7864, 7866, 7868, 7870, 7872,
    7874, 7876, 7878, 7880, 7882, 7884, 7886, 7888, 7890, 7892, 7894, 7896, 7898,
    7900, 7902, 7904, 7906, 7908, 7910, 7912, 7914, 7916, 7918, 7920, 7922, 7924,
    7926, 7928, 7930, 7932, 7934, 7944-7951, 7960-7965, 7976-7983, 7992-7999,
    8008-8013, 8025, 8027, 8029, 8031, 8040-8047, 8120-8123, 8136-8139,
    8152-8155, 8168-8172, 8184-8187, 8450, 8455, 8459-8461, 8464-8466, 8469,
    8473-8477, 8484, 8486, 8488, 8490-8493, 8496-8499, 8510-8511, 8517,
    8544-8559, 8579, 9398-9423, 11264-11311, 11360, 11362-11364, 11367, 11369,
    11371, 11373-11376, 11378, 11381, 11390-11392, 11394, 11396, 11398, 11400,
    11402, 11404, 11406, 11408, 11410, 11412, 11414, 11416, 11418, 11420, 11422,
    11424, 11426, 11428, 11430, 11432, 11434, 11436, 11438, 11440, 11442, 11444,
    11446, 11448, 11450, 11452, 11454, 11456, 11458, 11460, 11462, 11464, 11466,
    11468, 11470, 11472, 11474, 11476, 11478, 11480, 11482, 11484, 11486, 11488,
    11490, 11499, 11501, 11506, 42560, 42562, 42564, 42566, 42568, 42570, 42572,
    42574, 42576, 42578, 42580, 42582, 42584, 42586, 42588, 42590, 42592, 42594,
    42596, 42598, 42600, 42602, 42604, 42624, 42626, 42628, 42630, 42632, 42634,
    42636, 42638, 42640, 42642, 42644, 42646, 42648, 42650, 42786, 42788, 42790,
    42792, 42794, 42796, 42798, 42802, 42804, 42806, 42808, 42810, 42812, 42814,
    42816, 42818, 42820, 42822, 42824, 42826, 42828, 42830, 42832, 42834, 42836,
    42838, 42840, 42842, 42844, 42846, 42848, 42850, 42852, 42854, 42856, 42858,
    42860, 42862, 42873, 42875, 42877-42878, 42880, 42882, 42884, 42886, 42891,
    42893, 42896, 42898, 42902, 42904, 42906, 42908, 42910, 42912, 42914, 42916,
    42918, 42920, 42922-42926, 42928-42932, 42934, 42936, 42938, 42940, 42942,
    42944, 42946, 42948-42951, 42953, 42955-42956, 42958, 42960, 42962, 42964,
    42966, 42968, 42970, 42972, 42997, 65313-65338, 66560-66599, 66736-66771,
    66928-66938, 66940-66954, 66956-66962, 66964-66965, 68736-68786, 68944-68965,
    71840-71871, 93760-93791, 93856-93880, 119808-119833, 119860-119885,
    119912-119937, 119964, 119966-119967, 119970, 119973-119974, 119977-119980,
    119982-119989, 120016-120041, 120068-120069, 120071-120074, 120077-120084,
    120086-120092, 120120-120121, 120123-120126, 120128-120132, 120134,
    120138-120144, 120172-120197, 120224-120249, 120276-120301, 120328-120353,
    120380-120405, 120432-120457, 120488-120512, 120546-120570, 120604-120628,
    120662-120686, 120720-120744, 120778, 125184-125217, 127280-127305,
    127312-127337,
    127344-127369
    |}]
;;

let%expect_test "alpha" =
  Format.printf "%a@." Cset.pp Cset.alpha;
  [%expect {|
    65-90, 97-122, 170, 181, 186, 192-214, 216-246, 248-705, 710-721, 736-740,
    748, 750, 837, 867-884, 886-887, 890-893, 895, 902, 904-906, 908, 910-929,
    931-1013, 1015-1153, 1162-1327, 1329-1366, 1369, 1376-1416, 1456-1469, 1471,
    1473-1474, 1476-1477, 1479, 1488-1514, 1519-1522, 1552-1562, 1568-1623,
    1625-1631, 1646-1747, 1749-1756, 1761-1768, 1773-1775, 1786-1788, 1791,
    1808-1855, 1869-1969, 1994-2026, 2036-2037, 2042, 2048-2071, 2074-2092,
    2112-2136, 2144-2154, 2160-2183, 2185-2191, 2199, 2208-2249, 2260-2271,
    2275-2281, 2288-2363, 2365-2380, 2382-2384, 2389-2403, 2417-2435, 2437-2444,
    2447-2448, 2451-2472, 2474-2480, 2482, 2486-2489, 2493-2500, 2503-2504,
    2507-2508, 2510, 2519, 2524-2525, 2527-2531, 2544-2545, 2556, 2561-2563,
    2565-2570, 2575-2576, 2579-2600, 2602-2608, 2610-2611, 2613-2614, 2616-2617,
    2622-2626, 2631-2632, 2635-2636, 2641, 2649-2652, 2654, 2672-2677, 2689-2691,
    2693-2701, 2703-2705, 2707-2728, 2730-2736, 2738-2739, 2741-2745, 2749-2757,
    2759-2761, 2763-2764, 2768, 2784-2787, 2809-2812, 2817-2819, 2821-2828,
    2831-2832, 2835-2856, 2858-2864, 2866-2867, 2869-2873, 2877-2884, 2887-2888,
    2891-2892, 2902-2903, 2908-2909, 2911-2915, 2929, 2946-2947, 2949-2954,
    2958-2960, 2962-2965, 2969-2970, 2972, 2974-2975, 2979-2980, 2984-2986,
    2990-3001, 3006-3010, 3014-3016, 3018-3020, 3024, 3031, 3072-3084, 3086-3088,
    3090-3112, 3114-3129, 3133-3140, 3142-3144, 3146-3148, 3157-3158, 3160-3162,
    3164-3165, 3168-3171, 3200-3203, 3205-3212, 3214-3216, 3218-3240, 3242-3251,
    3253-3257, 3261-3268, 3270-3272, 3274-3276, 3285-3286, 3292-3294, 3296-3299,
    3313-3315, 3328-3340, 3342-3344, 3346-3386, 3389-3396, 3398-3400, 3402-3404,
    3406, 3412-3415, 3423-3427, 3450-3455, 3457-3459, 3461-3478, 3482-3505,
    3507-3515, 3517, 3520-3526, 3535-3540, 3542, 3544-3551, 3570-3571, 3585-3642,
    3648-3654, 3661, 3713-3714, 3716, 3718-3722, 3724-3747, 3749, 3751-3769,
    3771-3773, 3776-3780, 3782, 3789, 3804-3807, 3840, 3904-3911, 3913-3948,
    3953-3971, 3976-3991, 3993-4028, 4096-4150, 4152, 4155-4159, 4176-4239,
    4250-4253, 4256-4293, 4295, 4301, 4304-4346, 4348-4680, 4682-4685, 4688-4694,
    4696, 4698-4701, 4704-4744, 4746-4749, 4752-4784, 4786-4789, 4792-4798, 4800,
    4802-4805, 4808-4822, 4824-4880, 4882-4885, 4888-4954, 4992-5007, 5024-5109,
    5112-5117, 5121-5740, 5743-5759, 5761-5786, 5792-5866, 5870-5880, 5888-5907,
    5919-5939, 5952-5971, 5984-5996, 5998-6000, 6002-6003, 6016-6067, 6070-6088,
    6103, 6108, 6176-6264, 6272-6314, 6320-6389, 6400-6430, 6432-6443, 6448-6456,
    6480-6509, 6512-6516, 6528-6571, 6576-6601, 6656-6683, 6688-6750, 6753-6772,
    6823, 6847-6848, 6860-6862, 6912-6963, 6965-6979, 6981-6988, 7040-7081,
    7084-7087, 7098-7141, 7143-7153, 7168-7222, 7245-7247, 7258-7293, 7296-7306,
    7312-7354, 7357-7359, 7401-7404, 7406-7411, 7413-7414, 7418, 7424-7615,
    7635-7668, 7680-7957, 7960-7965, 7968-8005, 8008-8013, 8016-8023, 8025, 8027,
    8029, 8031-8061, 8064-8116, 8118-8124, 8126, 8130-8132, 8134-8140, 8144-8147,
    8150-8155, 8160-8172, 8178-8180, 8182-8188, 8305, 8319, 8336-8348, 8450,
    8455, 8458-8467, 8469, 8473-8477, 8484, 8486, 8488, 8490-8493, 8495-8505,
    8508-8511, 8517-8521, 8526, 8544-8584, 9398-9449, 11264-11492, 11499-11502,
    11506-11507, 11520-11557, 11559, 11565, 11568-11623, 11631, 11648-11670,
    11680-11686, 11688-11694, 11696-11702, 11704-11710, 11712-11718, 11720-11726,
    11728-11734, 11736-11742, 11744-11775, 11823, 12293-12295, 12321-12329,
    12337-12341, 12344-12348, 12353-12438, 12445-12447, 12449-12538, 12540-12543,
    12549-12591, 12593-12686, 12704-12735, 12784-12799, 13312-19903, 19968-42124,
    42192-42237, 42240-42508, 42512-42527, 42538-42539, 42560-42606, 42612-42619,
    42623-42735, 42775-42783, 42786-42888, 42891-42972, 42993-43013, 43015-43047,
    43072-43123, 43136-43203, 43205, 43250-43255, 43259, 43261-43263,
    43274-43306, 43312-43346, 43360-43388, 43392-43442, 43444-43455, 43471,
    43488-43503, 43514-43518, 43520-43574, 43584-43597, 43616-43638, 43642-43710,
    43712, 43714, 43739-43741, 43744-43759, 43762-43765, 43777-43782,
    43785-43790, 43793-43798, 43808-43814, 43816-43822, 43824-43866, 43868-43881,
    43888-44010, 44032-55203, 55216-55238, 55243-55291, 63744-64109, 64112-64217,
    64256-64262, 64275-64279, 64285-64296, 64298-64310, 64312-64316, 64318,
    64320-64321, 64323-64324, 64326-64433, 64467-64829, 64848-64911, 64914-64967,
    65008-65019, 65136-65140, 65142-65276, 65313-65338, 65345-65370, 65382-65470,
    65474-65479, 65482-65487, 65490-65495, 65498-65500, 65536-65547, 65549-65574,
    65576-65594, 65596-65597, 65599-65613, 65616-65629, 65664-65786, 65856-65908,
    66176-66204, 66208-66256, 66304-66335, 66349-66378, 66384-66426, 66432-66461,
    66464-66499, 66504-66511, 66513-66517, 66560-66717, 66736-66771, 66776-66811,
    66816-66855, 66864-66915, 66928-66938, 66940-66954, 66956-66962, 66964-66965,
    66967-66977, 66979-66993, 66995-67001, 67003-67004, 67008-67059, 67072-67382,
    67392-67413, 67424-67431, 67456-67461, 67463-67504, 67506-67514, 67584-67589,
    67592, 67594-67637, 67639-67640, 67644, 67647-67669, 67680-67702,
    67712-67742, 67808-67826, 67828-67829, 67840-67861, 67872-67897, 67904-67929,
    67968-68023, 68030-68031, 68096-68099, 68101-68102, 68108-68115, 68117-68119,
    68121-68149, 68192-68220, 68224-68252, 68288-68295, 68297-68324, 68352-68405,
    68416-68437, 68448-68466, 68480-68497, 68608-68680, 68736-68786, 68800-68850,
    68864-68903, 68938-68965, 68969, 68975-68997, 69248-69289, 69291-69292,
    69296-69297, 69314-69319, 69370-69372, 69376-69404, 69415, 69424-69445,
    69488-69505, 69552-69572, 69600-69622, 69632-69701, 69745-69749, 69760-69816,
    69826, 69840-69864, 69888-69938, 69956-69959, 69968-70002, 70006,
    70016-70079, 70081-70084, 70094-70095, 70106, 70108, 70144-70161,
    70163-70196, 70199, 70206-70209, 70272-70278, 70280, 70282-70285,
    70287-70301, 70303-70312, 70320-70376, 70400-70403, 70405-70412, 70415-70416,
    70419-70440, 70442-70448, 70450-70451, 70453-70457, 70461-70468, 70471-70472,
    70475-70476, 70480, 70487, 70493-70499, 70528-70537, 70539, 70542,
    70544-70581, 70583-70592, 70594, 70597, 70599-70602, 70604-70605, 70609,
    70611, 70656-70721, 70723-70725, 70727-70730, 70751-70753, 70784-70849,
    70852-70853, 70855, 71040-71093, 71096-71102, 71128-71133, 71168-71230,
    71232, 71236, 71296-71349, 71352, 71424-71450, 71453-71466, 71488-71494,
    71680-71736, 71840-71903, 71935-71942, 71945, 71948-71955, 71957-71958,
    71960-71989, 71991-71992, 71995-71996, 71999-72002, 72096-72103, 72106-72151,
    72154-72159, 72161, 72163-72164, 72192-72242, 72245-72254, 72272-72343,
    72349, 72368-72440, 72544-72551, 72640-72672, 72704-72712, 72714-72758,
    72760-72766, 72768, 72818-72847, 72850-72871, 72873-72886, 72960-72966,
    72968-72969, 72971-73014, 73018, 73020-73021, 73023-73025, 73027,
    73030-73031, 73056-73061, 73063-73064, 73066-73102, 73104-73105, 73107-73110,
    73112, 73136-73179, 73440-73462, 73472-73488, 73490-73530, 73534-73536,
    73648, 73728-74649, 74752-74862, 74880-75075, 77712-77808, 77824-78895,
    78913-78918, 78944-82938, 82944-83526, 90368-90414, 92160-92728, 92736-92766,
    92784-92862, 92880-92909, 92928-92975, 92992-92995, 93027-93047, 93053-93071,
    93504-93548, 93760-93823, 93856-93880, 93883-93907, 93952-94026, 94031-94087,
    94095-94111, 94176-94177, 94179, 94192-94198, 94208-101589, 101631-101662,
    101760-101874, 110576-110579, 110581-110587, 110589-110590, 110592-110882,
    110898, 110928-110930, 110933, 110948-110951, 110960-111355, 113664-113770,
    113776-113788, 113792-113800, 113808-113817, 113822, 119808-119892,
    119894-119964, 119966-119967, 119970, 119973-119974, 119977-119980,
    119982-119993, 119995, 119997-120003, 120005-120069, 120071-120074,
    120077-120084, 120086-120092, 120094-120121, 120123-120126, 120128-120132,
    120134, 120138-120144, 120146-120485, 120488-120512, 120514-120538,
    120540-120570, 120572-120596, 120598-120628, 120630-120654, 120656-120686,
    120688-120712, 120714-120744, 120746-120770, 120772-120779, 122624-122654,
    122661-122666, 122880-122886, 122888-122904, 122907-122913, 122915-122916,
    122918-122922, 122928-122989, 123023, 123136-123180, 123191-123197, 123214,
    123536-123565, 123584-123627, 124112-124139, 124368-124397, 124400,
    124608-124638, 124640-124661, 124670-124671, 124896-124902, 124904-124907,
    124909-124910, 124912-124926, 124928-125124, 125184-125251, 125255, 125259,
    126464-126467, 126469-126495, 126497-126498, 126500, 126503, 126505-126514,
    126516-126519, 126521, 126523, 126530, 126535, 126537, 126539, 126541-126543,
    126545-126546, 126548, 126551, 126553, 126555, 126557, 126559, 126561-126562,
    126564, 126567-126570, 126572-126578, 126580-126583, 126585-126588, 126590,
    126592-126601, 126603-126619, 126625-126627, 126629-126633, 126635-126651,
    127280-127305, 127312-127337, 127344-127369, 131072-173791, 173824-178205,
    178208-183981, 183984-191456, 191472-192093, 194560-195101, 196608-201546,
    201552-210041
    |}]
;;

let%expect_test "alnum" =
  Format.printf "%a@." Cset.pp Cset.alnum;
  [%expect {|
    48-57, 65-90, 97-122, 170, 178-179, 181, 185-186, 188-190, 192-214, 216-246,
    248-705, 710-721, 736-740, 748, 750, 837, 867-884, 886-887, 890-893, 895,
    902, 904-906, 908, 910-929, 931-1013, 1015-1153, 1162-1327, 1329-1366, 1369,
    1376-1416, 1456-1469, 1471, 1473-1474, 1476-1477, 1479, 1488-1514, 1519-1522,
    1552-1562, 1568-1623, 1625-1641, 1646-1747, 1749-1756, 1761-1768, 1773-1788,
    1791, 1808-1855, 1869-1969, 1984-2026, 2036-2037, 2042, 2048-2071, 2074-2092,
    2112-2136, 2144-2154, 2160-2183, 2185-2191, 2199, 2208-2249, 2260-2271,
    2275-2281, 2288-2363, 2365-2380, 2382-2384, 2389-2403, 2406-2415, 2417-2435,
    2437-2444, 2447-2448, 2451-2472, 2474-2480, 2482, 2486-2489, 2493-2500,
    2503-2504, 2507-2508, 2510, 2519, 2524-2525, 2527-2531, 2534-2545, 2548-2553,
    2556, 2561-2563, 2565-2570, 2575-2576, 2579-2600, 2602-2608, 2610-2611,
    2613-2614, 2616-2617, 2622-2626, 2631-2632, 2635-2636, 2641, 2649-2652, 2654,
    2662-2677, 2689-2691, 2693-2701, 2703-2705, 2707-2728, 2730-2736, 2738-2739,
    2741-2745, 2749-2757, 2759-2761, 2763-2764, 2768, 2784-2787, 2790-2799,
    2809-2812, 2817-2819, 2821-2828, 2831-2832, 2835-2856, 2858-2864, 2866-2867,
    2869-2873, 2877-2884, 2887-2888, 2891-2892, 2902-2903, 2908-2909, 2911-2915,
    2918-2927, 2929-2935, 2946-2947, 2949-2954, 2958-2960, 2962-2965, 2969-2970,
    2972, 2974-2975, 2979-2980, 2984-2986, 2990-3001, 3006-3010, 3014-3016,
    3018-3020, 3024, 3031, 3046-3058, 3072-3084, 3086-3088, 3090-3112, 3114-3129,
    3133-3140, 3142-3144, 3146-3148, 3157-3158, 3160-3162, 3164-3165, 3168-3171,
    3174-3183, 3192-3198, 3200-3203, 3205-3212, 3214-3216, 3218-3240, 3242-3251,
    3253-3257, 3261-3268, 3270-3272, 3274-3276, 3285-3286, 3292-3294, 3296-3299,
    3302-3311, 3313-3315, 3328-3340, 3342-3344, 3346-3386, 3389-3396, 3398-3400,
    3402-3404, 3406, 3412-3427, 3430-3448, 3450-3455, 3457-3459, 3461-3478,
    3482-3505, 3507-3515, 3517, 3520-3526, 3535-3540, 3542, 3544-3551, 3558-3567,
    3570-3571, 3585-3642, 3648-3654, 3661, 3664-3673, 3713-3714, 3716, 3718-3722,
    3724-3747, 3749, 3751-3769, 3771-3773, 3776-3780, 3782, 3789, 3792-3801,
    3804-3807, 3840, 3872-3891, 3904-3911, 3913-3948, 3953-3971, 3976-3991,
    3993-4028, 4096-4150, 4152, 4155-4169, 4176-4253, 4256-4293, 4295, 4301,
    4304-4346, 4348-4680, 4682-4685, 4688-4694, 4696, 4698-4701, 4704-4744,
    4746-4749, 4752-4784, 4786-4789, 4792-4798, 4800, 4802-4805, 4808-4822,
    4824-4880, 4882-4885, 4888-4954, 4969-4988, 4992-5007, 5024-5109, 5112-5117,
    5121-5740, 5743-5759, 5761-5786, 5792-5866, 5870-5880, 5888-5907, 5919-5939,
    5952-5971, 5984-5996, 5998-6000, 6002-6003, 6016-6067, 6070-6088, 6103, 6108,
    6112-6121, 6128-6137, 6160-6169, 6176-6264, 6272-6314, 6320-6389, 6400-6430,
    6432-6443, 6448-6456, 6470-6509, 6512-6516, 6528-6571, 6576-6601, 6608-6618,
    6656-6683, 6688-6750, 6753-6772, 6784-6793, 6800-6809, 6823, 6847-6848,
    6860-6862, 6912-6963, 6965-6979, 6981-6988, 6992-7001, 7040-7081, 7084-7141,
    7143-7153, 7168-7222, 7232-7241, 7245-7293, 7296-7306, 7312-7354, 7357-7359,
    7401-7404, 7406-7411, 7413-7414, 7418, 7424-7615, 7635-7668, 7680-7957,
    7960-7965, 7968-8005, 8008-8013, 8016-8023, 8025, 8027, 8029, 8031-8061,
    8064-8116, 8118-8124, 8126, 8130-8132, 8134-8140, 8144-8147, 8150-8155,
    8160-8172, 8178-8180, 8182-8188, 8304-8305, 8308-8313, 8319-8329, 8336-8348,
    8450, 8455, 8458-8467, 8469, 8473-8477, 8484, 8486, 8488, 8490-8493,
    8495-8505, 8508-8511, 8517-8521, 8526, 8528-8585, 9312-9371, 9398-9471,
    10102-10131, 11264-11492, 11499-11502, 11506-11507, 11517, 11520-11557,
    11559, 11565, 11568-11623, 11631, 11648-11670, 11680-11686, 11688-11694,
    11696-11702, 11704-11710, 11712-11718, 11720-11726, 11728-11734, 11736-11742,
    11744-11775, 11823, 12293-12295, 12321-12329, 12337-12341, 12344-12348,
    12353-12438, 12445-12447, 12449-12538, 12540-12543, 12549-12591, 12593-12686,
    12690-12693, 12704-12735, 12784-12799, 12832-12841, 12872-12879, 12881-12895,
    12928-12937, 12977-12991, 13312-19903, 19968-42124, 42192-42237, 42240-42508,
    42512-42539, 42560-42606, 42612-42619, 42623-42735, 42775-42783, 42786-42888,
    42891-42972, 42993-43013, 43015-43047, 43056-43061, 43072-43123, 43136-43203,
    43205, 43216-43225, 43250-43255, 43259, 43261-43306, 43312-43346,
    43360-43388, 43392-43442, 43444-43455, 43471-43481, 43488-43518, 43520-43574,
    43584-43597, 43600-43609, 43616-43638, 43642-43710, 43712, 43714,
    43739-43741, 43744-43759, 43762-43765, 43777-43782, 43785-43790, 43793-43798,
    43808-43814, 43816-43822, 43824-43866, 43868-43881, 43888-44010, 44016-44025,
    44032-55203, 55216-55238, 55243-55291, 63744-64109, 64112-64217, 64256-64262,
    64275-64279, 64285-64296, 64298-64310, 64312-64316, 64318, 64320-64321,
    64323-64324, 64326-64433, 64467-64829, 64848-64911, 64914-64967, 65008-65019,
    65136-65140, 65142-65276, 65296-65305, 65313-65338, 65345-65370, 65382-65470,
    65474-65479, 65482-65487, 65490-65495, 65498-65500, 65536-65547, 65549-65574,
    65576-65594, 65596-65597, 65599-65613, 65616-65629, 65664-65786, 65799-65843,
    65856-65912, 65930-65931, 66176-66204, 66208-66256, 66273-66299, 66304-66339,
    66349-66378, 66384-66426, 66432-66461, 66464-66499, 66504-66511, 66513-66517,
    66560-66717, 66720-66729, 66736-66771, 66776-66811, 66816-66855, 66864-66915,
    66928-66938, 66940-66954, 66956-66962, 66964-66965, 66967-66977, 66979-66993,
    66995-67001, 67003-67004, 67008-67059, 67072-67382, 67392-67413, 67424-67431,
    67456-67461, 67463-67504, 67506-67514, 67584-67589, 67592, 67594-67637,
    67639-67640, 67644, 67647-67669, 67672-67702, 67705-67742, 67751-67759,
    67808-67826, 67828-67829, 67835-67867, 67872-67897, 67904-67929, 67968-68023,
    68028-68047, 68050-68099, 68101-68102, 68108-68115, 68117-68119, 68121-68149,
    68160-68168, 68192-68222, 68224-68255, 68288-68295, 68297-68324, 68331-68335,
    68352-68405, 68416-68437, 68440-68466, 68472-68497, 68521-68527, 68608-68680,
    68736-68786, 68800-68850, 68858-68903, 68912-68921, 68928-68965, 68969,
    68975-68997, 69216-69246, 69248-69289, 69291-69292, 69296-69297, 69314-69319,
    69370-69372, 69376-69415, 69424-69445, 69457-69460, 69488-69505, 69552-69579,
    69600-69622, 69632-69701, 69714-69743, 69745-69749, 69760-69816, 69826,
    69840-69864, 69872-69881, 69888-69938, 69942-69951, 69956-69959, 69968-70002,
    70006, 70016-70079, 70081-70084, 70094-70106, 70108, 70113-70132,
    70144-70161, 70163-70196, 70199, 70206-70209, 70272-70278, 70280,
    70282-70285, 70287-70301, 70303-70312, 70320-70376, 70384-70393, 70400-70403,
    70405-70412, 70415-70416, 70419-70440, 70442-70448, 70450-70451, 70453-70457,
    70461-70468, 70471-70472, 70475-70476, 70480, 70487, 70493-70499,
    70528-70537, 70539, 70542, 70544-70581, 70583-70592, 70594, 70597,
    70599-70602, 70604-70605, 70609, 70611, 70656-70721, 70723-70725,
    70727-70730, 70736-70745, 70751-70753, 70784-70849, 70852-70853, 70855,
    70864-70873, 71040-71093, 71096-71102, 71128-71133, 71168-71230, 71232,
    71236, 71248-71257, 71296-71349, 71352, 71360-71369, 71376-71395,
    71424-71450, 71453-71466, 71472-71483, 71488-71494, 71680-71736, 71840-71922,
    71935-71942, 71945, 71948-71955, 71957-71958, 71960-71989, 71991-71992,
    71995-71996, 71999-72002, 72016-72025, 72096-72103, 72106-72151, 72154-72159,
    72161, 72163-72164, 72192-72242, 72245-72254, 72272-72343, 72349,
    72368-72440, 72544-72551, 72640-72672, 72688-72697, 72704-72712, 72714-72758,
    72760-72766, 72768, 72784-72812, 72818-72847, 72850-72871, 72873-72886,
    72960-72966, 72968-72969, 72971-73014, 73018, 73020-73021, 73023-73025,
    73027, 73030-73031, 73040-73049, 73056-73061, 73063-73064, 73066-73102,
    73104-73105, 73107-73110, 73112, 73120-73129, 73136-73179, 73184-73193,
    73440-73462, 73472-73488, 73490-73530, 73534-73536, 73552-73561, 73648,
    73664-73684, 73728-74649, 74752-74862, 74880-75075, 77712-77808, 77824-78895,
    78913-78918, 78944-82938, 82944-83526, 90368-90414, 90416-90425, 92160-92728,
    92736-92766, 92768-92777, 92784-92862, 92864-92873, 92880-92909, 92928-92975,
    92992-92995, 93008-93017, 93019-93025, 93027-93047, 93053-93071, 93504-93548,
    93552-93561, 93760-93846, 93856-93880, 93883-93907, 93952-94026, 94031-94087,
    94095-94111, 94176-94177, 94179, 94192-94198, 94208-101589, 101631-101662,
    101760-101874, 110576-110579, 110581-110587, 110589-110590, 110592-110882,
    110898, 110928-110930, 110933, 110948-110951, 110960-111355, 113664-113770,
    113776-113788, 113792-113800, 113808-113817, 113822, 118000-118009,
    119488-119507, 119520-119539, 119648-119672, 119808-119892, 119894-119964,
    119966-119967, 119970, 119973-119974, 119977-119980, 119982-119993, 119995,
    119997-120003, 120005-120069, 120071-120074, 120077-120084, 120086-120092,
    120094-120121, 120123-120126, 120128-120132, 120134, 120138-120144,
    120146-120485, 120488-120512, 120514-120538, 120540-120570, 120572-120596,
    120598-120628, 120630-120654, 120656-120686, 120688-120712, 120714-120744,
    120746-120770, 120772-120779, 120782-120831, 122624-122654, 122661-122666,
    122880-122886, 122888-122904, 122907-122913, 122915-122916, 122918-122922,
    122928-122989, 123023, 123136-123180, 123191-123197, 123200-123209, 123214,
    123536-123565, 123584-123627, 123632-123641, 124112-124139, 124144-124153,
    124368-124397, 124400-124410, 124608-124638, 124640-124661, 124670-124671,
    124896-124902, 124904-124907, 124909-124910, 124912-124926, 124928-125124,
    125127-125135, 125184-125251, 125255, 125259, 125264-125273, 126065-126123,
    126125-126127, 126129-126132, 126209-126253, 126255-126269, 126464-126467,
    126469-126495, 126497-126498, 126500, 126503, 126505-126514, 126516-126519,
    126521, 126523, 126530, 126535, 126537, 126539, 126541-126543, 126545-126546,
    126548, 126551, 126553, 126555, 126557, 126559, 126561-126562, 126564,
    126567-126570, 126572-126578, 126580-126583, 126585-126588, 126590,
    126592-126601, 126603-126619, 126625-126627, 126629-126633, 126635-126651,
    127232-127244, 127280-127305, 127312-127337, 127344-127369, 130032-130041,
    131072-173791, 173824-178205, 178208-183981, 183984-191456, 191472-192093,
    194560-195101, 196608-201546,
    201552-210041
    |}]
;;

let%expect_test "wordc" =
  Format.printf "%a@." Cset.pp Cset.wordc;
  [%expect {|
    48-57, 65-90, 95, 97-122, 170, 178-179, 181, 185-186, 188-190, 192-214,
    216-246, 248-705, 710-721, 736-740, 748, 750, 837, 867-884, 886-887, 890-893,
    895, 902, 904-906, 908, 910-929, 931-1013, 1015-1153, 1162-1327, 1329-1366,
    1369, 1376-1416, 1456-1469, 1471, 1473-1474, 1476-1477, 1479, 1488-1514,
    1519-1522, 1552-1562, 1568-1623, 1625-1641, 1646-1747, 1749-1756, 1761-1768,
    1773-1788, 1791, 1808-1855, 1869-1969, 1984-2026, 2036-2037, 2042, 2048-2071,
    2074-2092, 2112-2136, 2144-2154, 2160-2183, 2185-2191, 2199, 2208-2249,
    2260-2271, 2275-2281, 2288-2363, 2365-2380, 2382-2384, 2389-2403, 2406-2415,
    2417-2435, 2437-2444, 2447-2448, 2451-2472, 2474-2480, 2482, 2486-2489,
    2493-2500, 2503-2504, 2507-2508, 2510, 2519, 2524-2525, 2527-2531, 2534-2545,
    2548-2553, 2556, 2561-2563, 2565-2570, 2575-2576, 2579-2600, 2602-2608,
    2610-2611, 2613-2614, 2616-2617, 2622-2626, 2631-2632, 2635-2636, 2641,
    2649-2652, 2654, 2662-2677, 2689-2691, 2693-2701, 2703-2705, 2707-2728,
    2730-2736, 2738-2739, 2741-2745, 2749-2757, 2759-2761, 2763-2764, 2768,
    2784-2787, 2790-2799, 2809-2812, 2817-2819, 2821-2828, 2831-2832, 2835-2856,
    2858-2864, 2866-2867, 2869-2873, 2877-2884, 2887-2888, 2891-2892, 2902-2903,
    2908-2909, 2911-2915, 2918-2927, 2929-2935, 2946-2947, 2949-2954, 2958-2960,
    2962-2965, 2969-2970, 2972, 2974-2975, 2979-2980, 2984-2986, 2990-3001,
    3006-3010, 3014-3016, 3018-3020, 3024, 3031, 3046-3058, 3072-3084, 3086-3088,
    3090-3112, 3114-3129, 3133-3140, 3142-3144, 3146-3148, 3157-3158, 3160-3162,
    3164-3165, 3168-3171, 3174-3183, 3192-3198, 3200-3203, 3205-3212, 3214-3216,
    3218-3240, 3242-3251, 3253-3257, 3261-3268, 3270-3272, 3274-3276, 3285-3286,
    3292-3294, 3296-3299, 3302-3311, 3313-3315, 3328-3340, 3342-3344, 3346-3386,
    3389-3396, 3398-3400, 3402-3404, 3406, 3412-3427, 3430-3448, 3450-3455,
    3457-3459, 3461-3478, 3482-3505, 3507-3515, 3517, 3520-3526, 3535-3540, 3542,
    3544-3551, 3558-3567, 3570-3571, 3585-3642, 3648-3654, 3661, 3664-3673,
    3713-3714, 3716, 3718-3722, 3724-3747, 3749, 3751-3769, 3771-3773, 3776-3780,
    3782, 3789, 3792-3801, 3804-3807, 3840, 3872-3891, 3904-3911, 3913-3948,
    3953-3971, 3976-3991, 3993-4028, 4096-4150, 4152, 4155-4169, 4176-4253,
    4256-4293, 4295, 4301, 4304-4346, 4348-4680, 4682-4685, 4688-4694, 4696,
    4698-4701, 4704-4744, 4746-4749, 4752-4784, 4786-4789, 4792-4798, 4800,
    4802-4805, 4808-4822, 4824-4880, 4882-4885, 4888-4954, 4969-4988, 4992-5007,
    5024-5109, 5112-5117, 5121-5740, 5743-5759, 5761-5786, 5792-5866, 5870-5880,
    5888-5907, 5919-5939, 5952-5971, 5984-5996, 5998-6000, 6002-6003, 6016-6067,
    6070-6088, 6103, 6108, 6112-6121, 6128-6137, 6160-6169, 6176-6264, 6272-6314,
    6320-6389, 6400-6430, 6432-6443, 6448-6456, 6470-6509, 6512-6516, 6528-6571,
    6576-6601, 6608-6618, 6656-6683, 6688-6750, 6753-6772, 6784-6793, 6800-6809,
    6823, 6847-6848, 6860-6862, 6912-6963, 6965-6979, 6981-6988, 6992-7001,
    7040-7081, 7084-7141, 7143-7153, 7168-7222, 7232-7241, 7245-7293, 7296-7306,
    7312-7354, 7357-7359, 7401-7404, 7406-7411, 7413-7414, 7418, 7424-7615,
    7635-7668, 7680-7957, 7960-7965, 7968-8005, 8008-8013, 8016-8023, 8025, 8027,
    8029, 8031-8061, 8064-8116, 8118-8124, 8126, 8130-8132, 8134-8140, 8144-8147,
    8150-8155, 8160-8172, 8178-8180, 8182-8188, 8304-8305, 8308-8313, 8319-8329,
    8336-8348, 8450, 8455, 8458-8467, 8469, 8473-8477, 8484, 8486, 8488,
    8490-8493, 8495-8505, 8508-8511, 8517-8521, 8526, 8528-8585, 9312-9371,
    9398-9471, 10102-10131, 11264-11492, 11499-11502, 11506-11507, 11517,
    11520-11557, 11559, 11565, 11568-11623, 11631, 11648-11670, 11680-11686,
    11688-11694, 11696-11702, 11704-11710, 11712-11718, 11720-11726, 11728-11734,
    11736-11742, 11744-11775, 11823, 12293-12295, 12321-12329, 12337-12341,
    12344-12348, 12353-12438, 12445-12447, 12449-12538, 12540-12543, 12549-12591,
    12593-12686, 12690-12693, 12704-12735, 12784-12799, 12832-12841, 12872-12879,
    12881-12895, 12928-12937, 12977-12991, 13312-19903, 19968-42124, 42192-42237,
    42240-42508, 42512-42539, 42560-42606, 42612-42619, 42623-42735, 42775-42783,
    42786-42888, 42891-42972, 42993-43013, 43015-43047, 43056-43061, 43072-43123,
    43136-43203, 43205, 43216-43225, 43250-43255, 43259, 43261-43306,
    43312-43346, 43360-43388, 43392-43442, 43444-43455, 43471-43481, 43488-43518,
    43520-43574, 43584-43597, 43600-43609, 43616-43638, 43642-43710, 43712,
    43714, 43739-43741, 43744-43759, 43762-43765, 43777-43782, 43785-43790,
    43793-43798, 43808-43814, 43816-43822, 43824-43866, 43868-43881, 43888-44010,
    44016-44025, 44032-55203, 55216-55238, 55243-55291, 63744-64109, 64112-64217,
    64256-64262, 64275-64279, 64285-64296, 64298-64310, 64312-64316, 64318,
    64320-64321, 64323-64324, 64326-64433, 64467-64829, 64848-64911, 64914-64967,
    65008-65019, 65136-65140, 65142-65276, 65296-65305, 65313-65338, 65345-65370,
    65382-65470, 65474-65479, 65482-65487, 65490-65495, 65498-65500, 65536-65547,
    65549-65574, 65576-65594, 65596-65597, 65599-65613, 65616-65629, 65664-65786,
    65799-65843, 65856-65912, 65930-65931, 66176-66204, 66208-66256, 66273-66299,
    66304-66339, 66349-66378, 66384-66426, 66432-66461, 66464-66499, 66504-66511,
    66513-66517, 66560-66717, 66720-66729, 66736-66771, 66776-66811, 66816-66855,
    66864-66915, 66928-66938, 66940-66954, 66956-66962, 66964-66965, 66967-66977,
    66979-66993, 66995-67001, 67003-67004, 67008-67059, 67072-67382, 67392-67413,
    67424-67431, 67456-67461, 67463-67504, 67506-67514, 67584-67589, 67592,
    67594-67637, 67639-67640, 67644, 67647-67669, 67672-67702, 67705-67742,
    67751-67759, 67808-67826, 67828-67829, 67835-67867, 67872-67897, 67904-67929,
    67968-68023, 68028-68047, 68050-68099, 68101-68102, 68108-68115, 68117-68119,
    68121-68149, 68160-68168, 68192-68222, 68224-68255, 68288-68295, 68297-68324,
    68331-68335, 68352-68405, 68416-68437, 68440-68466, 68472-68497, 68521-68527,
    68608-68680, 68736-68786, 68800-68850, 68858-68903, 68912-68921, 68928-68965,
    68969, 68975-68997, 69216-69246, 69248-69289, 69291-69292, 69296-69297,
    69314-69319, 69370-69372, 69376-69415, 69424-69445, 69457-69460, 69488-69505,
    69552-69579, 69600-69622, 69632-69701, 69714-69743, 69745-69749, 69760-69816,
    69826, 69840-69864, 69872-69881, 69888-69938, 69942-69951, 69956-69959,
    69968-70002, 70006, 70016-70079, 70081-70084, 70094-70106, 70108,
    70113-70132, 70144-70161, 70163-70196, 70199, 70206-70209, 70272-70278,
    70280, 70282-70285, 70287-70301, 70303-70312, 70320-70376, 70384-70393,
    70400-70403, 70405-70412, 70415-70416, 70419-70440, 70442-70448, 70450-70451,
    70453-70457, 70461-70468, 70471-70472, 70475-70476, 70480, 70487,
    70493-70499, 70528-70537, 70539, 70542, 70544-70581, 70583-70592, 70594,
    70597, 70599-70602, 70604-70605, 70609, 70611, 70656-70721, 70723-70725,
    70727-70730, 70736-70745, 70751-70753, 70784-70849, 70852-70853, 70855,
    70864-70873, 71040-71093, 71096-71102, 71128-71133, 71168-71230, 71232,
    71236, 71248-71257, 71296-71349, 71352, 71360-71369, 71376-71395,
    71424-71450, 71453-71466, 71472-71483, 71488-71494, 71680-71736, 71840-71922,
    71935-71942, 71945, 71948-71955, 71957-71958, 71960-71989, 71991-71992,
    71995-71996, 71999-72002, 72016-72025, 72096-72103, 72106-72151, 72154-72159,
    72161, 72163-72164, 72192-72242, 72245-72254, 72272-72343, 72349,
    72368-72440, 72544-72551, 72640-72672, 72688-72697, 72704-72712, 72714-72758,
    72760-72766, 72768, 72784-72812, 72818-72847, 72850-72871, 72873-72886,
    72960-72966, 72968-72969, 72971-73014, 73018, 73020-73021, 73023-73025,
    73027, 73030-73031, 73040-73049, 73056-73061, 73063-73064, 73066-73102,
    73104-73105, 73107-73110, 73112, 73120-73129, 73136-73179, 73184-73193,
    73440-73462, 73472-73488, 73490-73530, 73534-73536, 73552-73561, 73648,
    73664-73684, 73728-74649, 74752-74862, 74880-75075, 77712-77808, 77824-78895,
    78913-78918, 78944-82938, 82944-83526, 90368-90414, 90416-90425, 92160-92728,
    92736-92766, 92768-92777, 92784-92862, 92864-92873, 92880-92909, 92928-92975,
    92992-92995, 93008-93017, 93019-93025, 93027-93047, 93053-93071, 93504-93548,
    93552-93561, 93760-93846, 93856-93880, 93883-93907, 93952-94026, 94031-94087,
    94095-94111, 94176-94177, 94179, 94192-94198, 94208-101589, 101631-101662,
    101760-101874, 110576-110579, 110581-110587, 110589-110590, 110592-110882,
    110898, 110928-110930, 110933, 110948-110951, 110960-111355, 113664-113770,
    113776-113788, 113792-113800, 113808-113817, 113822, 118000-118009,
    119488-119507, 119520-119539, 119648-119672, 119808-119892, 119894-119964,
    119966-119967, 119970, 119973-119974, 119977-119980, 119982-119993, 119995,
    119997-120003, 120005-120069, 120071-120074, 120077-120084, 120086-120092,
    120094-120121, 120123-120126, 120128-120132, 120134, 120138-120144,
    120146-120485, 120488-120512, 120514-120538, 120540-120570, 120572-120596,
    120598-120628, 120630-120654, 120656-120686, 120688-120712, 120714-120744,
    120746-120770, 120772-120779, 120782-120831, 122624-122654, 122661-122666,
    122880-122886, 122888-122904, 122907-122913, 122915-122916, 122918-122922,
    122928-122989, 123023, 123136-123180, 123191-123197, 123200-123209, 123214,
    123536-123565, 123584-123627, 123632-123641, 124112-124139, 124144-124153,
    124368-124397, 124400-124410, 124608-124638, 124640-124661, 124670-124671,
    124896-124902, 124904-124907, 124909-124910, 124912-124926, 124928-125124,
    125127-125135, 125184-125251, 125255, 125259, 125264-125273, 126065-126123,
    126125-126127, 126129-126132, 126209-126253, 126255-126269, 126464-126467,
    126469-126495, 126497-126498, 126500, 126503, 126505-126514, 126516-126519,
    126521, 126523, 126530, 126535, 126537, 126539, 126541-126543, 126545-126546,
    126548, 126551, 126553, 126555, 126557, 126559, 126561-126562, 126564,
    126567-126570, 126572-126578, 126580-126583, 126585-126588, 126590,
    126592-126601, 126603-126619, 126625-126627, 126629-126633, 126635-126651,
    127232-127244, 127280-127305, 127312-127337, 127344-127369, 130032-130041,
    131072-173791, 173824-178205, 178208-183981, 183984-191456, 191472-192093,
    194560-195101, 196608-201546,
    201552-210041
    |}]
;;

let%expect_test "cntrl" =
  Format.printf "%a@." Cset.pp Cset.cntrl;
  [%expect {|
    0-31,
    127-159
    |}]
;;

let%expect_test "graph" =
  Format.printf "%a@." Cset.pp Cset.graph;
  [%expect {|
    32-126, 160-172, 174-887, 890-895, 900-906, 908, 910-929, 931-1327,
    1329-1366, 1369-1418, 1421-1423, 1425-1479, 1488-1514, 1519-1524, 1542-1563,
    1565-1756, 1758-1805, 1808-1866, 1869-1969, 1984-2042, 2045-2093, 2096-2110,
    2112-2139, 2142, 2144-2154, 2160-2191, 2199-2273, 2275-2435, 2437-2444,
    2447-2448, 2451-2472, 2474-2480, 2482, 2486-2489, 2492-2500, 2503-2504,
    2507-2510, 2519, 2524-2525, 2527-2531, 2534-2558, 2561-2563, 2565-2570,
    2575-2576, 2579-2600, 2602-2608, 2610-2611, 2613-2614, 2616-2617, 2620,
    2622-2626, 2631-2632, 2635-2637, 2641, 2649-2652, 2654, 2662-2678, 2689-2691,
    2693-2701, 2703-2705, 2707-2728, 2730-2736, 2738-2739, 2741-2745, 2748-2757,
    2759-2761, 2763-2765, 2768, 2784-2787, 2790-2801, 2809-2815, 2817-2819,
    2821-2828, 2831-2832, 2835-2856, 2858-2864, 2866-2867, 2869-2873, 2876-2884,
    2887-2888, 2891-2893, 2901-2903, 2908-2909, 2911-2915, 2918-2935, 2946-2947,
    2949-2954, 2958-2960, 2962-2965, 2969-2970, 2972, 2974-2975, 2979-2980,
    2984-2986, 2990-3001, 3006-3010, 3014-3016, 3018-3021, 3024, 3031, 3046-3066,
    3072-3084, 3086-3088, 3090-3112, 3114-3129, 3132-3140, 3142-3144, 3146-3149,
    3157-3158, 3160-3162, 3164-3165, 3168-3171, 3174-3183, 3191-3212, 3214-3216,
    3218-3240, 3242-3251, 3253-3257, 3260-3268, 3270-3272, 3274-3277, 3285-3286,
    3292-3294, 3296-3299, 3302-3311, 3313-3315, 3328-3340, 3342-3344, 3346-3396,
    3398-3400, 3402-3407, 3412-3427, 3430-3455, 3457-3459, 3461-3478, 3482-3505,
    3507-3515, 3517, 3520-3526, 3530, 3535-3540, 3542, 3544-3551, 3558-3567,
    3570-3572, 3585-3642, 3647-3675, 3713-3714, 3716, 3718-3722, 3724-3747, 3749,
    3751-3773, 3776-3780, 3782, 3784-3790, 3792-3801, 3804-3807, 3840-3911,
    3913-3948, 3953-3991, 3993-4028, 4030-4044, 4046-4058, 4096-4293, 4295, 4301,
    4304-4680, 4682-4685, 4688-4694, 4696, 4698-4701, 4704-4744, 4746-4749,
    4752-4784, 4786-4789, 4792-4798, 4800, 4802-4805, 4808-4822, 4824-4880,
    4882-4885, 4888-4954, 4957-4988, 4992-5017, 5024-5109, 5112-5117, 5120-5788,
    5792-5880, 5888-5909, 5919-5942, 5952-5971, 5984-5996, 5998-6000, 6002-6003,
    6016-6109, 6112-6121, 6128-6137, 6144-6157, 6159-6169, 6176-6264, 6272-6314,
    6320-6389, 6400-6430, 6432-6443, 6448-6459, 6464, 6468-6509, 6512-6516,
    6528-6571, 6576-6601, 6608-6618, 6622-6683, 6686-6750, 6752-6780, 6783-6793,
    6800-6809, 6816-6829, 6832-6877, 6880-6891, 6912-6988, 6990-7155, 7164-7223,
    7227-7241, 7245-7306, 7312-7354, 7357-7367, 7376-7418, 7424-7957, 7960-7965,
    7968-8005, 8008-8013, 8016-8023, 8025, 8027, 8029, 8031-8061, 8064-8116,
    8118-8132, 8134-8147, 8150-8155, 8157-8175, 8178-8180, 8182-8190, 8192-8202,
    8208-8231, 8239-8287, 8304-8305, 8308-8334, 8336-8348, 8352-8385, 8400-8432,
    8448-8587, 8592-9257, 9280-9290, 9312-11123, 11126-11507, 11513-11557, 11559,
    11565, 11568-11623, 11631-11632, 11647-11670, 11680-11686, 11688-11694,
    11696-11702, 11704-11710, 11712-11718, 11720-11726, 11728-11734, 11736-11742,
    11744-11869, 11904-11929, 11931-12019, 12032-12245, 12272-12351, 12353-12438,
    12441-12543, 12549-12591, 12593-12686, 12688-12773, 12783-12830, 12832-42124,
    42128-42182, 42192-42539, 42560-42743, 42752-42972, 42993-43052, 43056-43065,
    43072-43127, 43136-43205, 43214-43225, 43232-43347, 43359-43388, 43392-43469,
    43471-43481, 43486-43518, 43520-43574, 43584-43597, 43600-43609, 43612-43714,
    43739-43766, 43777-43782, 43785-43790, 43793-43798, 43808-43814, 43816-43822,
    43824-43883, 43888-44013, 44016-44025, 44032-55203, 55216-55238, 55243-55291,
    63744-64109, 64112-64217, 64256-64262, 64275-64279, 64285-64310, 64312-64316,
    64318, 64320-64321, 64323-64324, 64326-64975, 65008-65049, 65056-65106,
    65108-65126, 65128-65131, 65136-65140, 65142-65276, 65281-65470, 65474-65479,
    65482-65487, 65490-65495, 65498-65500, 65504-65510, 65512-65518, 65532-65533,
    65536-65547, 65549-65574, 65576-65594, 65596-65597, 65599-65613, 65616-65629,
    65664-65786, 65792-65794, 65799-65843, 65847-65934, 65936-65948, 65952,
    66000-66045, 66176-66204, 66208-66256, 66272-66299, 66304-66339, 66349-66378,
    66384-66426, 66432-66461, 66463-66499, 66504-66517, 66560-66717, 66720-66729,
    66736-66771, 66776-66811, 66816-66855, 66864-66915, 66927-66938, 66940-66954,
    66956-66962, 66964-66965, 66967-66977, 66979-66993, 66995-67001, 67003-67004,
    67008-67059, 67072-67382, 67392-67413, 67424-67431, 67456-67461, 67463-67504,
    67506-67514, 67584-67589, 67592, 67594-67637, 67639-67640, 67644,
    67647-67669, 67671-67742, 67751-67759, 67808-67826, 67828-67829, 67835-67867,
    67871-67897, 67903-67929, 67968-68023, 68028-68047, 68050-68099, 68101-68102,
    68108-68115, 68117-68119, 68121-68149, 68152-68154, 68159-68168, 68176-68184,
    68192-68255, 68288-68326, 68331-68342, 68352-68405, 68409-68437, 68440-68466,
    68472-68497, 68505-68508, 68521-68527, 68608-68680, 68736-68786, 68800-68850,
    68858-68903, 68912-68921, 68928-68965, 68969-68997, 69006-69007, 69216-69246,
    69248-69289, 69291-69293, 69296-69297, 69314-69319, 69328-69336, 69370-69415,
    69424-69465, 69488-69513, 69552-69579, 69600-69622, 69632-69709, 69714-69749,
    69759-69820, 69822-69826, 69840-69864, 69872-69881, 69888-69940, 69942-69959,
    69968-70006, 70016-70111, 70113-70132, 70144-70161, 70163-70209, 70272-70278,
    70280, 70282-70285, 70287-70301, 70303-70313, 70320-70378, 70384-70393,
    70400-70403, 70405-70412, 70415-70416, 70419-70440, 70442-70448, 70450-70451,
    70453-70457, 70459-70468, 70471-70472, 70475-70477, 70480, 70487,
    70493-70499, 70502-70508, 70512-70516, 70528-70537, 70539, 70542,
    70544-70581, 70583-70592, 70594, 70597, 70599-70602, 70604-70613,
    70615-70616, 70625-70626, 70656-70747, 70749-70753, 70784-70855, 70864-70873,
    71040-71093, 71096-71133, 71168-71236, 71248-71257, 71264-71276, 71296-71353,
    71360-71369, 71376-71395, 71424-71450, 71453-71467, 71472-71494, 71680-71739,
    71840-71922, 71935-71942, 71945, 71948-71955, 71957-71958, 71960-71989,
    71991-71992, 71995-72006, 72016-72025, 72096-72103, 72106-72151, 72154-72164,
    72192-72263, 72272-72354, 72368-72440, 72448-72457, 72544-72551, 72640-72673,
    72688-72697, 72704-72712, 72714-72758, 72760-72773, 72784-72812, 72816-72847,
    72850-72871, 72873-72886, 72960-72966, 72968-72969, 72971-73014, 73018,
    73020-73021, 73023-73031, 73040-73049, 73056-73061, 73063-73064, 73066-73102,
    73104-73105, 73107-73112, 73120-73129, 73136-73179, 73184-73193, 73440-73464,
    73472-73488, 73490-73530, 73534-73562, 73648, 73664-73713, 73727-74649,
    74752-74862, 74864-74868, 74880-75075, 77712-77810, 77824-78895, 78912-78933,
    78944-82938, 82944-83526, 90368-90425, 92160-92728, 92736-92766, 92768-92777,
    92782-92862, 92864-92873, 92880-92909, 92912-92917, 92928-92997, 93008-93017,
    93019-93025, 93027-93047, 93053-93071, 93504-93561, 93760-93850, 93856-93880,
    93883-93907, 93952-94026, 94031-94087, 94095-94111, 94176-94180, 94192-94198,
    94208-101589, 101631-101662, 101760-101874, 110576-110579, 110581-110587,
    110589-110590, 110592-110882, 110898, 110928-110930, 110933, 110948-110951,
    110960-111355, 113664-113770, 113776-113788, 113792-113800, 113808-113817,
    113820-113823, 117760-118012, 118016-118451, 118458-118480, 118496-118512,
    118528-118573, 118576-118598, 118608-118723, 118784-119029, 119040-119078,
    119081-119154, 119163-119274, 119296-119365, 119488-119507, 119520-119539,
    119552-119638, 119648-119672, 119808-119892, 119894-119964, 119966-119967,
    119970, 119973-119974, 119977-119980, 119982-119993, 119995, 119997-120003,
    120005-120069, 120071-120074, 120077-120084, 120086-120092, 120094-120121,
    120123-120126, 120128-120132, 120134, 120138-120144, 120146-120485,
    120488-120779, 120782-121483, 121499-121503, 121505-121519, 122624-122654,
    122661-122666, 122880-122886, 122888-122904, 122907-122913, 122915-122916,
    122918-122922, 122928-122989, 123023, 123136-123180, 123184-123197,
    123200-123209, 123214-123215, 123536-123566, 123584-123641, 123647,
    124112-124153, 124368-124410, 124415, 124608-124638, 124640-124661,
    124670-124671, 124896-124902, 124904-124907, 124909-124910, 124912-124926,
    124928-125124, 125127-125142, 125184-125259, 125264-125273, 125278-125279,
    126065-126132, 126209-126269, 126464-126467, 126469-126495, 126497-126498,
    126500, 126503, 126505-126514, 126516-126519, 126521, 126523, 126530, 126535,
    126537, 126539, 126541-126543, 126545-126546, 126548, 126551, 126553, 126555,
    126557, 126559, 126561-126562, 126564, 126567-126570, 126572-126578,
    126580-126583, 126585-126588, 126590, 126592-126601, 126603-126619,
    126625-126627, 126629-126633, 126635-126651, 126704-126705, 126976-127019,
    127024-127123, 127136-127150, 127153-127167, 127169-127183, 127185-127221,
    127232-127405, 127462-127490, 127504-127547, 127552-127560, 127568-127569,
    127584-127589, 127744-128728, 128732-128748, 128752-128764, 128768-128985,
    128992-129003, 129008, 129024-129035, 129040-129095, 129104-129113,
    129120-129159, 129168-129197, 129200-129211, 129216-129217, 129232-129240,
    129280-129623, 129632-129645, 129648-129660, 129664-129674, 129678-129734,
    129736, 129741-129756, 129759-129770, 129775-129784, 129792-129938,
    129940-130042, 131072-173791, 173824-178205, 178208-183981, 183984-191456,
    191472-192093, 194560-195101, 196608-201546, 201552-210041,
    917760-917999
    |}]
;;

let%expect_test "print" =
  Format.printf "%a@." Cset.pp Cset.print;
  [%expect {|
    32-126, 161-172, 174-887, 890-895, 900-906, 908, 910-929, 931-1327,
    1329-1366, 1369-1418, 1421-1423, 1425-1479, 1488-1514, 1519-1524, 1542-1563,
    1565-1756, 1758-1805, 1808-1866, 1869-1969, 1984-2042, 2045-2093, 2096-2110,
    2112-2139, 2142, 2144-2154, 2160-2191, 2199-2273, 2275-2435, 2437-2444,
    2447-2448, 2451-2472, 2474-2480, 2482, 2486-2489, 2492-2500, 2503-2504,
    2507-2510, 2519, 2524-2525, 2527-2531, 2534-2558, 2561-2563, 2565-2570,
    2575-2576, 2579-2600, 2602-2608, 2610-2611, 2613-2614, 2616-2617, 2620,
    2622-2626, 2631-2632, 2635-2637, 2641, 2649-2652, 2654, 2662-2678, 2689-2691,
    2693-2701, 2703-2705, 2707-2728, 2730-2736, 2738-2739, 2741-2745, 2748-2757,
    2759-2761, 2763-2765, 2768, 2784-2787, 2790-2801, 2809-2815, 2817-2819,
    2821-2828, 2831-2832, 2835-2856, 2858-2864, 2866-2867, 2869-2873, 2876-2884,
    2887-2888, 2891-2893, 2901-2903, 2908-2909, 2911-2915, 2918-2935, 2946-2947,
    2949-2954, 2958-2960, 2962-2965, 2969-2970, 2972, 2974-2975, 2979-2980,
    2984-2986, 2990-3001, 3006-3010, 3014-3016, 3018-3021, 3024, 3031, 3046-3066,
    3072-3084, 3086-3088, 3090-3112, 3114-3129, 3132-3140, 3142-3144, 3146-3149,
    3157-3158, 3160-3162, 3164-3165, 3168-3171, 3174-3183, 3191-3212, 3214-3216,
    3218-3240, 3242-3251, 3253-3257, 3260-3268, 3270-3272, 3274-3277, 3285-3286,
    3292-3294, 3296-3299, 3302-3311, 3313-3315, 3328-3340, 3342-3344, 3346-3396,
    3398-3400, 3402-3407, 3412-3427, 3430-3455, 3457-3459, 3461-3478, 3482-3505,
    3507-3515, 3517, 3520-3526, 3530, 3535-3540, 3542, 3544-3551, 3558-3567,
    3570-3572, 3585-3642, 3647-3675, 3713-3714, 3716, 3718-3722, 3724-3747, 3749,
    3751-3773, 3776-3780, 3782, 3784-3790, 3792-3801, 3804-3807, 3840-3911,
    3913-3948, 3953-3991, 3993-4028, 4030-4044, 4046-4058, 4096-4293, 4295, 4301,
    4304-4680, 4682-4685, 4688-4694, 4696, 4698-4701, 4704-4744, 4746-4749,
    4752-4784, 4786-4789, 4792-4798, 4800, 4802-4805, 4808-4822, 4824-4880,
    4882-4885, 4888-4954, 4957-4988, 4992-5017, 5024-5109, 5112-5117, 5120-5759,
    5761-5788, 5792-5880, 5888-5909, 5919-5942, 5952-5971, 5984-5996, 5998-6000,
    6002-6003, 6016-6109, 6112-6121, 6128-6137, 6144-6157, 6159-6169, 6176-6264,
    6272-6314, 6320-6389, 6400-6430, 6432-6443, 6448-6459, 6464, 6468-6509,
    6512-6516, 6528-6571, 6576-6601, 6608-6618, 6622-6683, 6686-6750, 6752-6780,
    6783-6793, 6800-6809, 6816-6829, 6832-6877, 6880-6891, 6912-6988, 6990-7155,
    7164-7223, 7227-7241, 7245-7306, 7312-7354, 7357-7367, 7376-7418, 7424-7957,
    7960-7965, 7968-8005, 8008-8013, 8016-8023, 8025, 8027, 8029, 8031-8061,
    8064-8116, 8118-8132, 8134-8147, 8150-8155, 8157-8175, 8178-8180, 8182-8190,
    8208-8231, 8240-8286, 8304-8305, 8308-8334, 8336-8348, 8352-8385, 8400-8432,
    8448-8587, 8592-9257, 9280-9290, 9312-11123, 11126-11507, 11513-11557, 11559,
    11565, 11568-11623, 11631-11632, 11647-11670, 11680-11686, 11688-11694,
    11696-11702, 11704-11710, 11712-11718, 11720-11726, 11728-11734, 11736-11742,
    11744-11869, 11904-11929, 11931-12019, 12032-12245, 12272-12287, 12289-12351,
    12353-12438, 12441-12543, 12549-12591, 12593-12686, 12688-12773, 12783-12830,
    12832-42124, 42128-42182, 42192-42539, 42560-42743, 42752-42972, 42993-43052,
    43056-43065, 43072-43127, 43136-43205, 43214-43225, 43232-43347, 43359-43388,
    43392-43469, 43471-43481, 43486-43518, 43520-43574, 43584-43597, 43600-43609,
    43612-43714, 43739-43766, 43777-43782, 43785-43790, 43793-43798, 43808-43814,
    43816-43822, 43824-43883, 43888-44013, 44016-44025, 44032-55203, 55216-55238,
    55243-55291, 63744-64109, 64112-64217, 64256-64262, 64275-64279, 64285-64310,
    64312-64316, 64318, 64320-64321, 64323-64324, 64326-64975, 65008-65049,
    65056-65106, 65108-65126, 65128-65131, 65136-65140, 65142-65276, 65281-65470,
    65474-65479, 65482-65487, 65490-65495, 65498-65500, 65504-65510, 65512-65518,
    65532-65533, 65536-65547, 65549-65574, 65576-65594, 65596-65597, 65599-65613,
    65616-65629, 65664-65786, 65792-65794, 65799-65843, 65847-65934, 65936-65948,
    65952, 66000-66045, 66176-66204, 66208-66256, 66272-66299, 66304-66339,
    66349-66378, 66384-66426, 66432-66461, 66463-66499, 66504-66517, 66560-66717,
    66720-66729, 66736-66771, 66776-66811, 66816-66855, 66864-66915, 66927-66938,
    66940-66954, 66956-66962, 66964-66965, 66967-66977, 66979-66993, 66995-67001,
    67003-67004, 67008-67059, 67072-67382, 67392-67413, 67424-67431, 67456-67461,
    67463-67504, 67506-67514, 67584-67589, 67592, 67594-67637, 67639-67640,
    67644, 67647-67669, 67671-67742, 67751-67759, 67808-67826, 67828-67829,
    67835-67867, 67871-67897, 67903-67929, 67968-68023, 68028-68047, 68050-68099,
    68101-68102, 68108-68115, 68117-68119, 68121-68149, 68152-68154, 68159-68168,
    68176-68184, 68192-68255, 68288-68326, 68331-68342, 68352-68405, 68409-68437,
    68440-68466, 68472-68497, 68505-68508, 68521-68527, 68608-68680, 68736-68786,
    68800-68850, 68858-68903, 68912-68921, 68928-68965, 68969-68997, 69006-69007,
    69216-69246, 69248-69289, 69291-69293, 69296-69297, 69314-69319, 69328-69336,
    69370-69415, 69424-69465, 69488-69513, 69552-69579, 69600-69622, 69632-69709,
    69714-69749, 69759-69820, 69822-69826, 69840-69864, 69872-69881, 69888-69940,
    69942-69959, 69968-70006, 70016-70111, 70113-70132, 70144-70161, 70163-70209,
    70272-70278, 70280, 70282-70285, 70287-70301, 70303-70313, 70320-70378,
    70384-70393, 70400-70403, 70405-70412, 70415-70416, 70419-70440, 70442-70448,
    70450-70451, 70453-70457, 70459-70468, 70471-70472, 70475-70477, 70480,
    70487, 70493-70499, 70502-70508, 70512-70516, 70528-70537, 70539, 70542,
    70544-70581, 70583-70592, 70594, 70597, 70599-70602, 70604-70613,
    70615-70616, 70625-70626, 70656-70747, 70749-70753, 70784-70855, 70864-70873,
    71040-71093, 71096-71133, 71168-71236, 71248-71257, 71264-71276, 71296-71353,
    71360-71369, 71376-71395, 71424-71450, 71453-71467, 71472-71494, 71680-71739,
    71840-71922, 71935-71942, 71945, 71948-71955, 71957-71958, 71960-71989,
    71991-71992, 71995-72006, 72016-72025, 72096-72103, 72106-72151, 72154-72164,
    72192-72263, 72272-72354, 72368-72440, 72448-72457, 72544-72551, 72640-72673,
    72688-72697, 72704-72712, 72714-72758, 72760-72773, 72784-72812, 72816-72847,
    72850-72871, 72873-72886, 72960-72966, 72968-72969, 72971-73014, 73018,
    73020-73021, 73023-73031, 73040-73049, 73056-73061, 73063-73064, 73066-73102,
    73104-73105, 73107-73112, 73120-73129, 73136-73179, 73184-73193, 73440-73464,
    73472-73488, 73490-73530, 73534-73562, 73648, 73664-73713, 73727-74649,
    74752-74862, 74864-74868, 74880-75075, 77712-77810, 77824-78895, 78912-78933,
    78944-82938, 82944-83526, 90368-90425, 92160-92728, 92736-92766, 92768-92777,
    92782-92862, 92864-92873, 92880-92909, 92912-92917, 92928-92997, 93008-93017,
    93019-93025, 93027-93047, 93053-93071, 93504-93561, 93760-93850, 93856-93880,
    93883-93907, 93952-94026, 94031-94087, 94095-94111, 94176-94180, 94192-94198,
    94208-101589, 101631-101662, 101760-101874, 110576-110579, 110581-110587,
    110589-110590, 110592-110882, 110898, 110928-110930, 110933, 110948-110951,
    110960-111355, 113664-113770, 113776-113788, 113792-113800, 113808-113817,
    113820-113823, 117760-118012, 118016-118451, 118458-118480, 118496-118512,
    118528-118573, 118576-118598, 118608-118723, 118784-119029, 119040-119078,
    119081-119154, 119163-119274, 119296-119365, 119488-119507, 119520-119539,
    119552-119638, 119648-119672, 119808-119892, 119894-119964, 119966-119967,
    119970, 119973-119974, 119977-119980, 119982-119993, 119995, 119997-120003,
    120005-120069, 120071-120074, 120077-120084, 120086-120092, 120094-120121,
    120123-120126, 120128-120132, 120134, 120138-120144, 120146-120485,
    120488-120779, 120782-121483, 121499-121503, 121505-121519, 122624-122654,
    122661-122666, 122880-122886, 122888-122904, 122907-122913, 122915-122916,
    122918-122922, 122928-122989, 123023, 123136-123180, 123184-123197,
    123200-123209, 123214-123215, 123536-123566, 123584-123641, 123647,
    124112-124153, 124368-124410, 124415, 124608-124638, 124640-124661,
    124670-124671, 124896-124902, 124904-124907, 124909-124910, 124912-124926,
    124928-125124, 125127-125142, 125184-125259, 125264-125273, 125278-125279,
    126065-126132, 126209-126269, 126464-126467, 126469-126495, 126497-126498,
    126500, 126503, 126505-126514, 126516-126519, 126521, 126523, 126530, 126535,
    126537, 126539, 126541-126543, 126545-126546, 126548, 126551, 126553, 126555,
    126557, 126559, 126561-126562, 126564, 126567-126570, 126572-126578,
    126580-126583, 126585-126588, 126590, 126592-126601, 126603-126619,
    126625-126627, 126629-126633, 126635-126651, 126704-126705, 126976-127019,
    127024-127123, 127136-127150, 127153-127167, 127169-127183, 127185-127221,
    127232-127405, 127462-127490, 127504-127547, 127552-127560, 127568-127569,
    127584-127589, 127744-128728, 128732-128748, 128752-128764, 128768-128985,
    128992-129003, 129008, 129024-129035, 129040-129095, 129104-129113,
    129120-129159, 129168-129197, 129200-129211, 129216-129217, 129232-129240,
    129280-129623, 129632-129645, 129648-129660, 129664-129674, 129678-129734,
    129736, 129741-129756, 129759-129770, 129775-129784, 129792-129938,
    129940-130042, 131072-173791, 173824-178205, 178208-183981, 183984-191456,
    191472-192093, 194560-195101, 196608-201546, 201552-210041,
    917760-917999
    |}]
;;

let%expect_test "punct" =
  Format.printf "%a@." Cset.pp Cset.punct;
  [%expect
    {|
    33-35, 37-42, 44-47, 58-59, 63-64, 91-93, 95, 123, 125, 161, 167, 171,
    182-183, 187, 191, 894, 903, 1370-1375, 1417-1418, 1470, 1472, 1475, 1478,
    1523-1524, 1545-1546, 1548-1549, 1563, 1565-1567, 1642-1645, 1748, 1792-1805,
    2039-2041, 2096-2110, 2142, 2404-2405, 2416, 2557, 2678, 2800, 3191, 3204,
    3572, 3663, 3674-3675, 3844-3858, 3860, 3898-3901, 3973, 4048-4052,
    4057-4058, 4170-4175, 4347, 4960-4968, 5120, 5742, 5787-5788, 5867-5869,
    5941-5942, 6100-6102, 6104-6106, 6144-6154, 6468-6469, 6686-6687, 6816-6822,
    6824-6829, 6990-6991, 7002-7008, 7037-7039, 7164-7167, 7227-7231, 7294-7295,
    7360-7367, 7379, 8208-8231, 8240-8259, 8261-8273, 8275-8286, 8317-8318,
    8333-8334, 8968-8971, 9001-9002, 10088-10101, 10181-10182, 10214-10223,
    10627-10648, 10712-10715, 10748-10749, 11513-11516, 11518-11519, 11632,
    11776-11822, 11824-11855, 11858-11869, 12289-12291, 12296-12305, 12308-12319,
    12336, 12349, 12448, 12539, 42238-42239, 42509-42511, 42611, 42622,
    42738-42743, 43124-43127, 43214-43215, 43256-43258, 43260, 43310-43311,
    43359, 43457-43469, 43486-43487, 43612-43615, 43742-43743, 43760-43761,
    44011, 64830-64831, 65040-65049, 65072-65106, 65108-65121, 65123, 65128,
    65130-65131, 65281-65283, 65285-65290, 65292-65295, 65306-65307, 65311-65312,
    65339-65341, 65343, 65371, 65373, 65375-65381, 65792-65794, 66463, 66512,
    66927, 67671, 67871, 67903, 68176-68184, 68223, 68336-68342, 68409-68415,
    68505-68508, 68974, 69293, 69328, 69461-69465, 69510-69513, 69703-69709,
    69819-69820, 69822-69825, 69952-69955, 70004-70005, 70085-70088, 70093,
    70107, 70109-70111, 70200-70205, 70313, 70612-70613, 70615-70616,
    70731-70735, 70746-70747, 70749, 70854, 71105-71127, 71233-71235,
    71264-71276, 71353, 71484-71486, 71739, 72004-72006, 72162, 72255-72262,
    72346-72348, 72350-72354, 72448-72457, 72673, 72769-72773, 72816-72817,
    73463-73464, 73539-73551, 73727, 74864-74868, 77809-77810, 92782-92783,
    92917, 92983-92987, 92996, 93549-93551, 93847-93850, 94178, 113823,
    121479-121483, 124415,
    125278-125279
    |}]
;;

let%expect_test "cany" =
  Format.printf "%a@." Cset.pp Cset.cany;
  [%expect {|
    0-55295,
    57344-1114111
    |}]
;;

let%expect_test "case_insens" =
  let cset = Cset.diff (Cset.case_insens Cset.lower) (Cset.case_insens Cset.upper) in
  Format.printf "%a@." Cset.pp cset;
  [%expect {|
    91-96, 149-170, 181, 186, 191-215, 223, 257, 259, 261, 263, 265, 267, 269,
    271, 273, 275, 277, 279, 281, 283, 285, 287, 289, 291, 293, 295, 297, 299,
    301, 303, 305, 307, 309, 311, 331, 333, 335, 337, 339, 341, 343, 355, 357,
    359-361, 363, 365, 367, 369, 371, 373, 375, 382-387, 389, 394-397, 400-402,
    404-405, 413-414, 419, 421, 424, 429, 434-436, 438, 440-442, 449-453, 456,
    459, 464, 468, 470, 474, 479, 481, 483, 485, 489, 491, 495-498, 501, 503-505,
    507, 509, 511, 513, 515, 517, 519, 521, 523, 525, 527, 531, 533, 537, 539,
    541, 543, 545, 547, 549, 551, 553, 555, 557, 559, 561, 563, 575, 583, 585,
    587, 589, 591, 662-696, 704-705, 736-740, 837, 849-881, 883, 887, 890-893,
    909, 930, 976-977, 981-983, 985, 987, 989, 991, 993, 995, 997, 999, 1001,
    1003, 1005, 1013, 1019, 1040-1119, 1121, 1123, 1125, 1127, 1129, 1131, 1133,
    1135, 1137, 1139, 1141, 1143, 1145, 1147, 1149, 1151, 1153, 1163, 1165, 1167,
    1169, 1171, 1173, 1175, 1177, 1179, 1181, 1183, 1185, 1187, 1189, 1191, 1193,
    1195, 1197, 1199, 1201, 1203, 1205, 1207, 1209, 1211, 1213, 1215, 1233, 1235,
    1237, 1239, 1241, 1243, 1245, 1247, 1251, 1253, 1255, 1257, 1259, 1261, 1263,
    1265, 1267, 1269, 1271, 1273, 1275, 1277, 1279, 1281, 1283, 1285, 1287, 1289,
    1291, 1293, 1295, 1297, 1299, 1301, 1303, 1305, 1307, 1309, 1311, 1313, 1315,
    1317, 1319, 1321, 1323, 1325, 1327, 4272-4346, 4348-4351, 5080-5117,
    7264-7304, 7306, 7649-7681, 7683, 7685, 7687, 7689, 7691, 7693, 7695, 7697,
    7699, 7701, 7703, 7705, 7707, 7709, 7711, 7713, 7715, 7717, 7719, 7721, 7723,
    7725, 7727, 7729, 7731, 7733, 7735, 7737, 7739, 7741, 7743, 7745, 7747, 7749,
    7751, 7753, 7755, 7757, 7759, 7761, 7763, 7765, 7767, 7769, 7771, 7773, 7775,
    7777, 7779, 7781, 7783, 7785, 7787, 7789, 7791, 7793, 7795, 7797, 7799, 7801,
    7803, 7805, 7807, 7809, 7811, 7813, 7815, 7817, 7819, 7821, 7823, 7825, 7827,
    7829, 7839, 7841, 7843, 7845, 7847, 7849, 7851, 7853, 7855, 7857, 7859, 7861,
    7863, 7865, 7867, 7869, 7871, 7873, 7875, 7877, 7879, 7881, 7883, 7885, 7887,
    7889, 7891, 7893, 7895, 7897, 7899, 7901, 7903, 7905, 7907, 7909, 7911, 7913,
    7915, 7917, 7919, 7921, 7923, 7925, 7927, 7929, 7931, 7933, 7935, 7952-7975,
    7984-7991, 8000-8007, 8032-8039, 8048-8056, 8064-8071, 8080-8087, 8094-8103,
    8112-8116, 8118-8119, 8126, 8128-8135, 8144-8151, 8160-8167, 8178-8180,
    8182-8183, 8319, 8336-8348, 8426-8454, 8456-8458, 8462-8463, 8467-8468,
    8470-8472, 8478-8481, 8485, 8489, 8494-8495, 8500, 8508-8509, 8526,
    8548-8575, 9424-9429, 11280-11359, 11361, 11365-11366, 11368, 11370, 11372,
    11377, 11379-11380, 11382-11389, 11393, 11397, 11401, 11403, 11405, 11407,
    11409, 11411, 11415, 11417, 11419, 11421, 11425, 11427, 11429, 11431, 11433,
    11435, 11437, 11439, 11441, 11443, 11445, 11447, 11449, 11451, 11453, 11455,
    11457, 11459, 11461, 11463, 11465, 11467, 11469, 11471, 11473, 11475, 11477,
    11479, 11481, 11483, 11485, 11487, 11489, 11491, 11507, 11559, 11565,
    42529-42561, 42563, 42565, 42567, 42569, 42571, 42573, 42575, 42577, 42579,
    42581, 42583, 42585, 42587, 42589, 42591, 42593, 42595, 42597, 42599, 42601,
    42603, 42605, 42625, 42627, 42629, 42631, 42633, 42635, 42637, 42639, 42641,
    42643, 42645, 42647, 42649, 42651-42653, 42787, 42789, 42791, 42793, 42795,
    42797, 42799-42801, 42803, 42805, 42807, 42809, 42811, 42813, 42815, 42817,
    42819, 42821, 42823, 42825, 42827, 42829, 42831, 42833, 42835, 42837, 42839,
    42841, 42843, 42845, 42847, 42849, 42851, 42853, 42855, 42857, 42859, 42861,
    42863, 42879, 42881, 42883, 42885, 42887, 42894-42897, 42899-42901, 42903,
    42907, 42909, 42911, 42913, 42915, 42917, 42919, 42921, 42927, 42933, 42935,
    42937, 42939, 42941, 42943, 42945, 42947, 42954, 42957, 42959, 42963, 42965,
    42967, 42969, 42971, 42998, 43000-43002, 43792-43967, 64224-64262,
    64275-64279, 65313-65344, 66568-66639, 66744-66811, 66935-66939, 66955,
    66979-66993, 66995-67001, 67003-67004, 67456, 67459-67461, 67463-67504,
    67506-67514, 68768-68850, 68944-68975, 71840-71903, 93760-93823, 93851-93887,
    119802-119839, 119886-119891, 119894-119943, 119965-119972, 119975-119976,
    119981, 119990-119993, 119995, 120005-120047, 120075-120076, 120085,
    120093-120099, 120127, 120133, 120135-120137, 120145-120151, 120198-120203,
    120250-120255, 120302-120307, 120354-120359, 120406-120411, 120458-120463,
    120513-120519, 120540-120577, 120598-120635, 120656-120693, 120714-120751,
    120772-120777, 120779, 122661-122666, 122928-122989,
    125186-125251
    |}]
;;

let%expect_test "one_char" =
  let test set =
    let pp fmt cp =
      Fmt.(opt Cset.CodePage.pp) fmt cp
    in
    Format.printf "%a@." pp (Cset.one_c set)
  in
  test Cset.empty;
  [%expect {| <None> |}];
  test (Cset.CodePage.of_char 'c' |> Cset.csingle );
  [%expect {| 99 |}];
  test Cset.cany;
  [%expect {| <None> |}]
;;

let%expect_test "is_empty" =
  let test set = Format.printf "%a@." Fmt.bool (Cset.is_empty set) in
  test Cset.empty;
  [%expect {| true |}];
  test (Cset.CodePage.of_char 'c' |> Cset.csingle);
  [%expect {| false |}];
  test Cset.cany;
  [%expect {| false |}]
;;

let%expect_test "Cset mem" =
  let test set c = Format.printf "%a@." Fmt.bool (Cset.mem c set) in
  test Cset.cany Cset.CodePage.null;
  [%expect {| false |}];
  test Cset.cany (Cset.CodePage.of_char 'a' |> Cset.CodePage.from_letter);
  [%expect {| true |}];
  let c = Cset.CodePage.of_char 'c' |> Cset.csingle in
  test c (Cset.CodePage.of_char 'c' |> Cset.CodePage.from_letter);
  [%expect {| true |}];
  test c (Cset.CodePage.of_char '.' |> Cset.CodePage.from_letter);
  [%expect {| false |}]
;;
